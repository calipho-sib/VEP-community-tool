{"version":3,"sources":["../../feature-viewer-test/feature-viewer/lib/index.js","../../feature-viewer-test/feature-viewer/src/feature-viewer.js","../../feature-viewer-test/feature-viewer/utils/icons.js","../../feature-viewer-test/feature-viewer/utils/data.js","../../feature-viewer-test/feature-viewer/src/fv.nextprot.js","utils/featureList.ts","utils/helpers/getFeatures.ts","utils/exportFile.ts","utils/constants.ts","components/Table.tsx","components/Isoform.tsx","components/FeatureViewer.tsx","utils/icons/nextprot-logo.png","App.tsx","reportWebVitals.ts","index.tsx"],"names":["global","jQuery","$","require","d3","createFeature","Nextprot","NXUtils","NXViewerUtils","nxFeatureViewer","mixin","prototype","module","exports","crossIcon","deleteIcon","bottomArrowIcon","dropdownOptions","sequence","div","options","self","this","events","FEATURE_SELECTED_EVENT","FEATURE_DESELECTED_EVENT","ZOOM_EVENT","GET_PREDICTIONS_EVENT","VARIANT_ADDED_EVENT","svgElement","el","document","getElementById","substring","intLength","Number","isInteger","fvLength","length","features","SVGOptions","showSequence","brushActive","verticalLine","dottedSequence","variant","offset","start","end","console","warn","svg","svgContainer","yAxisSVG","yAxisSVGgroup","seqPos","absoluteSeqPos","pathLevel","yData","Yposition","level","seqShift","zoomMax","current_extend","featureSelected","animation","singleVariant","multipleVariant","colorSelectedFeat","feat","object","select","id","style","originalColor","type","color","margin","width","height","scaling","scale","linear","domain","range","scalingPosition","updateLineTooltip","mouse","pD","xP","elemHover","l","x","helper","tooltip","tooltipDiv","selectedRect","bodyNode","node","tooltipColor","selection","on","pI","selectAll","remove","absoluteMousePos","rightside","append","attr","left","bottom","offsetHeight","padding","position","first_line","description","second_line","y","html","getBoundingClientRect","undefined","xTemp","yTemp","xRect","widthRect","nodeName","rect","previousSibling","svgWidth","getBBox","parseInt","top","CustomEvent","event","detail","dispatchEvent","trigger","_x","arguments","attrs","styles","X","d","displaySequence","seq","rectWidth","rectX","rectWidth2","addLevel","array","leveling","forEach","push","placed","k","onFeatureSelected","listener","addEventListener","onFeatureDeselected","onZoom","onGetPredictions","onVariantChanged","lineBond","line","interpolate","lineGen","lineYscale","xAxis","axis","tickFormat","format","orient","shadeBlendConvert","p","from","to","sbcRip","RGB","Object","split","i","slice","parseFloat","r","Math","round","h","b","f","t","toString","updateSVGHeight","yAxisScale","ordinal","rangeRoundBands","updateYaxis","data","enter","filter","join","text","title","forcePropagation","item","brush_elm","new_click_event","Event","pageX","clientX","pageY","clientY","tickValues","preComputing","sort","a","map","shift","unshift","maxValue","max","apply","o","abs","fillSVG","typeIdentifier","name","rectangle","unique","multipleRect","path","Array","isArray","negativeNumbers","seqSelected","e","showPopup","posX","calculatePos","window","singlePopup","hide","popupContainer","dropdown","dropdownWrapper","toggle","dropdownContainer","variantValue","values","callOnVariantChanged","log","addVariant","input","value","toUpperCase","getElementsByTagName","_","textContent","innerText","indexOf","display","dropdownOptionContainer","show","divPos","entries","key","parent","children","sequenceLine","transition","duration","rectHeight","rectShift","lineShift","rectsPro","dataline","className","rectsProGroup","call","uniqueShift","pathsDB","interpolation","fill","histog","dd","rects","showFilteredFeature","baseUrl","minY","maxY","gradient","url_gradient","url_dropshadow","hideFilteredFeature","transit1","transit2","brush","brushend","keys","constructor","info","extent","extentLength","empty","zoomScale","toFixed","currentShift","transition_data","reset_axis","zoom","clear","resetZoom","resetAll","resizeCallback","updateWindow","lastValue","splice","callOnGetPredictions","rest","addRectSelection","svgId","featSelection","elemSelected","tagName","fn","popover","bubbleHelp","unit","toolbar","headerOptions","headerPosition","headerZoom","helpContent","find","updateInputValues","idx","variantIndex","findIndex","m","originalValue","charAt","appendInputFields","variantValues","inputCount","inputWrapper","inputContainer","property","validateInput","not","lastSelectValue","lastInputValue","multipleVariantPopup","popup","multipleVariantContainer","showMultipleVariantPopup","each","$this","is","prop","checked","index","btnContainer","preventDefault","defs","feMerge","positionWithoutLetter","showAxis","vertical","mousex","addVerticalLine","initSVG","appendTo","addFeature","clearInstance","off","A","R","N","D","C","E","Q","G","H","I","L","K","M","F","P","S","T","W","Y","V","mergeData","oneData","metaData","viewer","featuresForViewer","convertMappingsToIsoformMap","featForViewer","convertNXAnnotations","addNxFeature","featuresName","featuresStyle","that","Promise","resolve","reject","all","nx","list","entry","getProteinSequence","getAntibody","getIsoformMapping","getAnnotationsByCategory","getFeaturesByview","nxClient","then","isoName","isoform","hasOwnProperty","feature","extend","filterFeatures","catch","err","message","stack","ft","startsWith","isoNb","nxEntry","iso","uniqueName","featureList","APIRef","metadata","addFeatures","currentFeature","getExportFileBlob","props","columns","fileType","headerNames","col","exportValue","csvString","Papa","unparse","fields","Blob","ERROR","RESULT_COLUMN_DATA","Header","accessor","Cell","row","GlobalFilter","preGlobalFilteredRows","globalFilter","setGlobalFilter","count","useState","setValue","onChange","useAsyncDebounce","target","placeholder","Table","useMemo","useTable","initialState","pageIndex","pageSize","useGlobalFilter","usePagination","useExportData","getTableProps","getTableBodyProps","headerGroups","prepareRow","page","state","canPreviousPage","canNextPage","pageOptions","pageCount","gotoPage","nextPage","previousPage","setPageSize","exportData","onClick","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","render","getRowProps","original","cells","cell","getCellProps","disabled","defaultValue","onBlur","Isoform","handleIsoformChange","setOptions","selectedOption","setSelectedOption","useEffect","optionMap","option","isoformAccession","label","FeatureViewerComponent","fv","setData","setIsoform","setIsoName","setFeatures","error","setError","Client","buildFeatures","sequences","onVariantAdded","v","sift","random","polyphen","paramEntry","URLSearchParams","location","search","get","getAnnotationsWithProperty","getFeaturesByView","rawData","featsForViewer","replace","getFeaturesByIsoform","getMetadataByView","innerHTML","App","src","nextprotLogo","alt","FeatureViewer","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.f629da9f.chunk.js","sourcesContent":["/*\n * feature-viewer\n * https://github.com/calipho-sib/feature-viewer\n *\n * Copyright (c) 2015 Calipho - SIB\n * Licensed under the GNU GPL v2 license.\n */\n\n/**\n @class FeatureViewer\n */\n\n\nglobal.jQuery = $ = require(\"jquery\");\nd3 = require(\"d3\");\nrequire(\"bootstrap/js/src/tooltip.js\");\nrequire(\"bootstrap/js/src/popover.js\");\n\nrequire(\"../css/style.css\");\n\nconst createFeature = require(\"../src/feature-viewer.js\");\n \n//Optional : usage with neXtProt\nconst Nextprot = require(\"nextprot/src/nextprot-core.js\");\nconst NXUtils = require(\"nextprot/src/nextprot-utils.js\")[\"NXUtils\"];\nconst NXViewerUtils = require(\"nextprot/src/nextprot-utils.js\")[\"NXViewerUtils\"];\n\n//Optional : usage with neXtProt\nconst nxFeatureViewer = require(\"../src/fv.nextprot.js\");\n\nrequire(\"biojs-events\").mixin(createFeature.prototype);\nmodule.exports = { createFeature, Nextprot, NXUtils, NXViewerUtils, nxFeatureViewer };","const { crossIcon, deleteIcon, bottomArrowIcon } = require('../utils/icons')\nconst { dropdownOptions } = require('../utils/data')\n\nfunction createFeature(sequence, div, options) {\n//        var nxSeq = sequence.startsWith('NX_') ? true : false;\n        var self = this;\n        // if (!div) var div = window;\n        this.events = {\n          FEATURE_SELECTED_EVENT: \"feature-viewer-position-selected\",\n            FEATURE_DESELECTED_EVENT: \"feature-viewer-position-deselected\",\n          ZOOM_EVENT: \"feature-viewer-zoom-altered\",\n          GET_PREDICTIONS_EVENT: \"feature-viewer-vep-predictions\",\n          VARIANT_ADDED_EVENT: \"feature-viewer-variant-added\"\n        };\n\n        // if (!div) var div = window;\n        var div = div;\n        var el = document.getElementById(div.substring(1));\n        var svgElement;\n        var sequence = sequence;\n        var intLength = Number.isInteger(sequence) ? sequence : null;\n        var fvLength = intLength | sequence.length;\n        var features = [];\n        var SVGOptions = {\n            showSequence: false,\n            brushActive: false,\n            verticalLine: false,\n            dottedSequence: true,\n            variant: false\n        };\n        var offset = {start:1,end:fvLength};\n        if (options && options.offset) {\n            offset = options.offset;\n            if (offset.start < 1) {\n                offset.start = 1;\n                console.warn(\"WARNING ! offset.start should be > 0. Thus, it has been reset to 1.\");\n            }\n        }\n        var pathLevel = 0;\n        var svg;\n        var svgContainer;\n        var filter;\n        var yData = [];\n        var yAxisSVG;\n        var yAxisSVGgroup;\n        var Yposition = 20;\n        var level = 0;\n        var seqShift = 0;\n        var zoom = false;\n        var zoomMax = 50;\n        var current_extend = { \n                    length : offset.end - offset.start,\n                    start : offset.start,\n                    end : offset.end\n                }\n        var featureSelected = {};\n        var animation = true;\n        \n        let seqPos; // Stores sequence + its position\n        let absoluteSeqPos; // Store only sequence position\n        let singleVariant = []; // Entered variant values\n        let multipleVariant = [] \n\n        function colorSelectedFeat(feat, object) {\n            //change color && memorize\n            if (featureSelected !== {}) d3.select(featureSelected.id).style(\"fill\", featureSelected.originalColor);\n            if (object.type !== \"path\" && object.type !== \"line\"){\n                featureSelected = {\"id\": feat, \"originalColor\": d3.select(feat).style(\"fill\") || object.color};\n                d3.select(feat).style(\"fill\", \"orangered\");\n            }\n        }\n\n        /**\n         * Private Methods\n         */\n\n            //Init box & scaling\n        d3.select(div)\n            .style(\"position\", \"relative\")\n            .style(\"padding\", \"0px\")\n            .style(\"z-index\", \"2\");\n\n        var margin = {\n                top: 10,\n                right: 20,\n                bottom: 20,\n                left: 110\n            },\n            width = $(div).width() - margin.left - margin.right - 17,\n            height = 600 - margin.top - margin.bottom;\n        var scaling = d3.scale.linear()\n            .domain([offset.start, offset.end])\n            .range([5, width-5]);\n        var scalingPosition = d3.scale.linear()\n            .domain([0, width])\n            .range([offset.start, offset.end]);\n        \n        \n        \n\n        function updateLineTooltip(mouse,pD){\n            var xP = mouse-110;\n            var elemHover = \"\";\n            for (var l=0; l<pD.length;l++) {\n                if (scaling(pD[l].x) < xP && scaling(pD[l+1].x) > xP) {\n                    if ((xP - scaling(pD[l].x)) < (scaling(pD[l+1].x) - xP )) {\n                        elemHover = pD[l];\n                    }\n                    else elemHover = pD[l+1];\n                    break;\n                }\n            }\n            return elemHover;\n        }\n        \n        d3.helper = {};\n\n        d3.helper.tooltip = function (object) {\n            var tooltipDiv;\n            var selectedRect;\n            var bodyNode = d3.select(div).node();\n            var tooltipColor = options.tooltipColor ? options.tooltipColor : \"orangered\";\n\n            function tooltip(selection) {\n\n                selection.on('mouseover.tooltip', function (pD, pI) {\n                    // Clean up lost tooltips\n                    d3.select('body').selectAll('div.tooltip').remove();\n                    // Append tooltip\n                    var absoluteMousePos = d3.mouse(bodyNode);\n                    var rightside = (absoluteMousePos[0] > width);\n                    if (rightside) {\n                        tooltipDiv = d3.select(div)\n                            .append('div')\n                            .attr('class', 'tooltip3');\n                    } else {\n                        tooltipDiv = d3.select(div)\n                            .append('div')\n                            .attr('class', 'tooltip2');\n                        tooltipDiv.style({\n                            left: (absoluteMousePos[0] - 15) + 'px'\n                        });\n                    }\n                    tooltipDiv.style({\n                        bottom: (bodyNode.offsetHeight - absoluteMousePos[1] + 16) + 'px',\n                        'background-color': '#eee',\n                        width: 'auto',\n                        'max-width': '170px',\n                        height: 'auto',\n                        'max-height': '68px',\n                        padding: '5px',\n                        \"font\": '10px sans-serif',\n                        'text-align': 'center',\n                        position: 'absolute',\n                        'z-index': 45,\n                        'box-shadow': '0 1px 2px 0 #656565' \n                    });\n                    if (object.type === \"path\") {\n                        var first_line = '<p style=\"margin:2px;font-weight:700;color:' + tooltipColor +'\">' + pD[0].x + '&#x256d;&#x256e;' + pD[1].x + '</p>';\n                        if (pD.description) var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + pD.description + '</p>';\n                        else var second_line = '';\n                    } else if (object.type === \"line\") {\n                        var elemHover = updateLineTooltip(absoluteMousePos[0],pD);\n                        if (elemHover.description) {\n                            var first_line = '<p style=\"margin:2px;font-weight:700;color:' + tooltipColor +'\">' + elemHover.x + ' : <span> ' + elemHover.y + '</span></p>';\n                            var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + elemHover.description + '</p>';\n                        }\n                        else {\n                            var first_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">position : <span id=\"tLineX\">' + elemHover.x + '</span></p>';\n                            var second_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">count : <span id=\"tLineC\">' + elemHover.y + '</span></p>';\n                        }\n                    } else if (object.type === \"unique\" || pD.x === pD.y) {\n                        var first_line = '<p style=\"margin:2px;font-weight:700;color:' + tooltipColor +'\">' + pD.x + '</p>';\n                        if (pD.description) var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + pD.description + '</p>';\n                        else var second_line = '';\n                    } else {\n                        var first_line = '<p style=\"margin:2px;font-weight:700;color:' + tooltipColor +'\">' + pD.x + ' - ' + pD.y + '</p>';\n                        if (pD.description) var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + pD.description + '</p>';\n                        else var second_line = '';\n                    }\n\n                    tooltipDiv.html(first_line + second_line);\n                    if (rightside) {\n                        tooltipDiv.style({\n                            left: (absoluteMousePos[0] + 10 - (tooltipDiv.node().getBoundingClientRect().width)) + 'px'\n                        })\n                    }\n                })\n                    .on('mousemove.tooltip', function (pD, pI) {\n                    \n                        if (object.type === \"line\") {\n                            var absoluteMousePos = d3.mouse(bodyNode);\n                            var elemHover = updateLineTooltip(absoluteMousePos[0],pD);\n                            if (elemHover.description) {\n                                var first_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">' + elemHover.x + ' : <span> ' + elemHover.y + '</span></p>';\n                                var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + elemHover.description + '</p>';\n                            }\n                            else {\n                                var first_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">position : <span id=\"tLineX\">' + elemHover.x + '</span></p>';\n                                var second_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">count : <span id=\"tLineC\">' + elemHover.y + '</span></p>';\n                            }\n                            tooltipDiv.html(first_line + second_line);\n//                            $('#tLineX').text(elemHover.x);\n//                            $('#tLineC').text(elemHover.y);  \n                        }\n                        // Move tooltip\n                        // IE 11 sometimes fires mousemove before mouseover\n                        if (tooltipDiv === undefined) { return; }\n                        var absoluteMousePos = d3.mouse(bodyNode);\n                        var rightside = (absoluteMousePos[0] > width);\n                        if (rightside) {\n                            tooltipDiv.attr(\"class\", \"tooltip3\");\n                            tooltipDiv.style({\n                                left: (absoluteMousePos[0] + 10 - (tooltipDiv.node().getBoundingClientRect().width)) + 'px',\n                                bottom: (bodyNode.offsetHeight - absoluteMousePos[1] + 16) + 'px'\n                            });\n                        } else {\n                            tooltipDiv.attr(\"class\", \"tooltip2\");\n                            tooltipDiv.style({\n                                left: (absoluteMousePos[0] - 15) + 'px',\n                                bottom: (bodyNode.offsetHeight - absoluteMousePos[1] + 16) + 'px'\n                            })\n                        }\n                    })\n                    .on('mouseout.tooltip', function (pD, pI) {\n                        // Remove tooltip\n                        tooltipDiv.remove();\n                    })\n                    .on('click', function (pD, pI) {\n                        var xTemp;\n                        var yTemp;\n                        var xRect;\n                        var widthRect;\n                        var elemHover;\n\n                        if(this.nodeName === \"text\") {\n                            var rect = \"#\"+this.previousSibling.id;\n                            if(rect.nodeName !== \"#\") colorSelectedFeat(rect, object);\n                        }\n                        else colorSelectedFeat(this, object);\n\n                        var svgWidth = SVGOptions.brushActive ? d3.select(\".background\").attr(\"width\") : svgContainer.node().getBBox().width;\n                        d3.select('body').selectAll('div.selectedRect').remove();\n                        // Append tooltip\n                        selectedRect = d3.select(div)\n                            .append('div')\n                            .attr('class', 'selectedRect');\n                        if (object.type === \"path\") {\n                            xTemp = pD[0].x;\n                            yTemp = pD[1].x;\n                        } else if (object.type === \"line\") {\n                            var absoluteMousePos = d3.mouse(bodyNode);\n                            elemHover = updateLineTooltip(absoluteMousePos[0],pD);\n                            xTemp = elemHover.x - 0.5;\n                            yTemp = elemHover.x + 0.5;\n                        } else if (object.type === \"unique\" || pD.x === pD.y) {\n                            xTemp = pD.x - 0.4;\n                            yTemp = pD.y + 0.4;\n                        } else {\n                            xTemp = pD.x;\n                            yTemp = pD.y;\n                        }\n\n                        if (scaling(xTemp) < 0 && scaling(yTemp) > svgWidth) {\n                            xRect = margin.left;\n                            widthRect = parseInt(svgWidth) + 5;\n                        } else if (scaling(xTemp) < 0) {\n                            xRect = margin.left;\n                            widthRect = (scaling(yTemp));\n                        } else if (scaling(yTemp) > svgWidth) {\n                            xRect = scaling(xTemp) + margin.left;\n                            widthRect = parseInt(svgWidth) - scaling(xTemp);\n                            widthRect =  widthRect + 5;\n                        } else {\n                            xRect = scaling(xTemp) + margin.left;\n                            widthRect = (scaling(yTemp) - scaling(xTemp));\n                        }\n                        selectedRect.style({\n                            left: xRect + 'px',\n                            top: ($(div + \" .svgHeader\").length) ? 60 + 'px' : 10 + 'px',\n                            'background-color': 'rgba(0, 0, 0, 0.2)',\n                            width: widthRect + 'px',\n                            height: (Yposition + 50) + 'px',\n                            position: 'absolute',\n                            'z-index': -1,\n                            'box-shadow': '0 1px 2px 0 #656565'\n                        });\n\n                        if (CustomEvent) {\n                            var event = new CustomEvent(self.events.FEATURE_SELECTED_EVENT, {\n                                detail: {\n                                    start: object.type === \"path\" ? pD[0].x : object.type === \"line\" ? elemHover.x : pD.x,\n                                    end: object.type === \"path\" ? pD[1].x : object.type === \"line\" ? elemHover.y : pD.y,\n                                    id: object.type === \"path\" ? pD[0].id : object.type === \"line\" ? elemHover.id : pD.id,\n                                    description:object.type === \"path\" ? pD[0].description : object.type === \"line\" ? elemHover.description : pD.description\n                                }\n                            });\n                            svgElement.dispatchEvent(event);\n                        } else {\n                            console.warn(\"CustomEvent is not defined....\");\n                        }\n                        if (self.trigger) self.trigger(self.events.FEATURE_SELECTED_EVENT, {\n                            start: object.type === \"path\" ? pD[0].x : object.type === \"line\" ? elemHover.x : pD.x,\n                            end: object.type === \"path\" ? pD[1].x : object.type === \"line\" ? elemHover.y : pD.y,\n                            id: object.type === \"path\" ? pD[0].id : object.type === \"line\" ? elemHover.id : pD.id,\n                            description:object.type === \"path\" ? pD[0].description : object.type === \"line\" ? elemHover.description : pD.description\n                        });\n\n                    });\n            }\n\n            tooltip.attr = function (_x) {\n                if (!arguments.length) return attrs;\n                attrs = _x;\n                return this;\n            };\n\n            tooltip.style = function (_x) {\n                if (!arguments.length) return styles;\n                styles = _x;\n                return this;\n            };\n\n            return tooltip;\n        };\n\n        //COMPUTING FUNCTION\n        var X = function (d) {\n            return scaling(d.x);\n        };\n        var displaySequence = function (seq) {\n            return width / seq > 5;\n        };\n        var rectWidth = function (d) {\n            return (scaling(d.y) - scaling(d.x));\n        };\n        function rectX(object) {\n            if (object.x === object.y) {\n                return scaling(object.x-0.4);\n            }\n            return scaling(object.x);\n        };\n        function rectWidth2(d){\n            if (d.x === d.y) {\n                if (scaling(d.x + 0.4) - scaling(d.x - 0.4) < 2) return 2;\n                else return scaling(d.x + 0.4) - scaling(d.x - 0.4);\n            }\n            return (scaling(d.y) - scaling(d.x));\n        };\n        var uniqueWidth = function (d) {\n            return (scaling(1));\n        };\n\n        this.onFeatureSelected = function (listener) {\n            svgElement.addEventListener(self.events.FEATURE_SELECTED_EVENT, listener);\n        };\n        this.onFeatureDeselected = function (listener) {\n            svgElement.addEventListener(self.events.FEATURE_DESELECTED_EVENT, listener);\n        };\n\n        this.onZoom = function (listener) {\n            svgElement.addEventListener(self.events.ZOOM_EVENT, listener);\n        };\n        this.onGetPredictions = function (listener) {\n            svgElement.addEventListener(self.events.GET_PREDICTIONS_EVENT, listener);\n        }\n        this.onVariantChanged = function (listener) {\n            svgElement.addEventListener(self.events.VARIANT_ADDED_EVENT, listener);\n        }\n\n        function addLevel(array) {\n            var leveling = [];\n            array.forEach(function (d) {\n                if (leveling === []) {\n                    leveling.push(d.y);\n                    d.level = 0;\n                } else {\n                    var placed = false;\n                    for (var k = 0; k < leveling.length; k++) {\n                        if (d.x > leveling[k]) {\n                            placed = true;\n                            d.level = k;\n                            leveling[k] = d.y;\n                            break;\n                        }\n                    }\n                    if (placed === false) {\n                        leveling.push(d.y);\n                        d.level = leveling.length - 1;\n                    }\n                }\n            });\n            return leveling.length;\n        }\n\n        function addLevelToBond(array) {\n            var leveling = [];\n            var newArray = [];\n            array.forEach(function (d) {\n                if (leveling === []) {\n                    leveling.push(d[2].x);\n                    d[1].y = 1;\n                } else {\n                    var placed = false;\n                    for (var k = 0; k < leveling.length; k++) {\n                        if (d[0].x > leveling[k]) {\n                            placed = true;\n                            d[1].y = k + 1;\n                            leveling[k] = d[2].x;\n                            break;\n                        }\n                    }\n                    if (placed === false) {\n                        leveling.push(d[2].x);\n                        d[1].y = leveling.length;\n                    }\n                }\n            });\n            return leveling.length;\n        }\n\n        var lineBond = d3.svg.line()\n            .interpolate(\"step-before\")\n            .x(function (d) {\n                return scaling(d.x);\n            })\n            .y(function (d) {\n                return -d.y * 10 + pathLevel;\n            });\n        var lineGen = d3.svg.line()\n          \n//          .interpolate(\"cardinal\")\n          .x(function(d) {\n            return scaling(d.x);\n          })\n          .y(function (d) {\n                return lineYscale(-d.y) * 10 + pathLevel;\n            });\n        var lineYscale = d3.scale.linear()\n            .domain([0,-30])\n            .range([0,-20]);\n        var line = d3.svg.line()\n            .interpolate(\"linear\")\n            .x(function (d) {\n                return scaling(d.x);\n            })\n            .y(function (d) {\n                return d.y + 6;\n            });\n\n        //Create Axis\n        var xAxis = d3.svg.axis()\n            .scale(scaling)\n            .tickFormat(d3.format(\"d\"))\n            .orient(\"bottom\");\n        \n        function shadeBlendConvert(p, from, to) {\n            if(typeof(p)!=\"number\"||p<-1||p>1||typeof(from)!=\"string\"||(from[0]!='r'&&from[0]!='#')||(typeof(to)!=\"string\"&&typeof(to)!=\"undefined\"))return null; //ErrorCheck\n            if(!this.sbcRip)this.sbcRip=function(d){\n                var l=d.length,RGB=new Object();\n                if(l>9){\n                    d=d.split(\",\");\n                    if(d.length<3||d.length>4)return null;//ErrorCheck\n                    RGB[0]=i(d[0].slice(4)),RGB[1]=i(d[1]),RGB[2]=i(d[2]),RGB[3]=d[3]?parseFloat(d[3]):-1;\n                }else{\n                    if(l==8||l==6||l<4)return null; //ErrorCheck\n                    if(l<6)d=\"#\"+d[1]+d[1]+d[2]+d[2]+d[3]+d[3]+(l>4?d[4]+\"\"+d[4]:\"\"); //3 digit\n                    d=i(d.slice(1),16),RGB[0]=d>>16&255,RGB[1]=d>>8&255,RGB[2]=d&255,RGB[3]=l==9||l==5?r(((d>>24&255)/255)*10000)/10000:-1;\n                }\n                return RGB;}\n            var i=parseInt,r=Math.round,h=from.length>9,h=typeof(to)==\"string\"?to.length>9?true:to==\"c\"?!h:false:h,b=p<0,p=b?p*-1:p,to=to&&to!=\"c\"?to:b?\"#000000\":\"#FFFFFF\",f=sbcRip(from),t=sbcRip(to);\n            if(!f||!t)return null; //ErrorCheck\n            if(h)return \"rgb(\"+r((t[0]-f[0])*p+f[0])+\",\"+r((t[1]-f[1])*p+f[1])+\",\"+r((t[2]-f[2])*p+f[2])+(f[3]<0&&t[3]<0?\")\":\",\"+(f[3]>-1&&t[3]>-1?r(((t[3]-f[3])*p+f[3])*10000)/10000:t[3]<0?f[3]:t[3])+\")\");\n            else return \"#\"+(0x100000000+(f[3]>-1&&t[3]>-1?r(((t[3]-f[3])*p+f[3])*255):t[3]>-1?r(t[3]*255):f[3]>-1?r(f[3]*255):255)*0x1000000+r((t[0]-f[0])*p+f[0])*0x10000+r((t[1]-f[1])*p+f[1])*0x100+r((t[2]-f[2])*p+f[2])).toString(16).slice(f[3]>-1||t[3]>-1?1:3);\n        }\n\n        function addXAxis(position) {\n            svgContainer.append(\"g\")\n                .attr(\"class\", \"x axis Xaxis\")\n                .attr(\"transform\", \"translate(0,\" + (position + 20) + \")\")\n                .call(xAxis);\n        }\n\n        function updateXaxis(position) {\n            svgContainer.selectAll(\".Xaxis\")\n                .attr(\"transform\", \"translate(0,\" + (position + 20) + \")\")\n        }\n\n        function updateSVGHeight(position) {\n            svg.attr(\"height\", position + 60 + \"px\");\n            svg.select(\"clippath rect\").attr(\"height\", position + 60 + \"px\");\n        }\n\n        var yAxisScale = d3.scale.ordinal()\n            .domain([0, yData.length])\n            .rangeRoundBands([0, 500], .1);\n        var yAxis = d3.svg.axis()\n            .scale(yAxisScale)\n            .tickValues(yData) //specify an array here for values\n            .tickFormat(function (d) {\n                return d\n            })\n            .orient(\"left\");\n\n        function addYAxis() {\n            yAxisSVG = svg.append(\"g\")\n                .attr(\"class\", \"pro axis\")\n                .attr(\"transform\", \"translate(0,\" + margin.top + \")\");\n            updateYaxis();\n        }\n\n        function updateYaxis() {\n\n            yAxisSVGgroup = yAxisSVG\n                .selectAll(\".yaxis\")\n                .data(yData)\n                .enter()\n                .append(\"g\");\n            yAxisSVGgroup\n                .append(\"polygon\") // attach a polygon\n                .attr(\"class\", function (d) {\n                    if (d.filter) return d.filter.split(\" \").join(\"_\") + \"Arrow\";\n                    return \"Arrow\";\n                })\n                .style(\"stroke\", \"\") // colour the line\n                .style(\"fill\", \"#DFD5D3\") // remove any fill colour\n                .attr(\"points\", function (d) {\n                    return (margin.left - 105) + \",\" + (d.y - 3) + \", \" + (margin.left - 105) + \",\" + (d.y + 12) + \", \" + (margin.left - 15) + \",\" + (d.y + 12) + \", \" + (margin.left - 7) + \",\" + (d.y + 4.5) + \", \" + (margin.left - 15) + \",\" + (d.y -3); // x,y points\n                });\n            yAxisSVGgroup\n                .append(\"text\")\n                .attr(\"class\", \"yaxis\")\n                .attr(\"text-anchor\", \"start\")\n                .attr(\"x\", function () {\n                    return margin.left - 102\n                })\n                .attr(\"y\", function (d) {\n                    return d.y + 8\n                })\n                .text(function (d) {\n                    return d.title\n                });\n        }\n\n        function forcePropagation(item) {\n            item.on('mousedown', function () {\n                brush_elm = svg.select(\".brush\").node();\n                new_click_event = new Event('mousedown');\n                new_click_event.pageX = d3.event.pageX;\n                new_click_event.clientX = d3.event.clientX;\n                new_click_event.pageY = d3.event.pageY;\n                new_click_event.clientY = d3.event.clientY;\n                if (brush_elm) {\n                    brush_elm.dispatchEvent(new_click_event);\n                }\n            });\n        }\n\n        /** export to new utils file  */\n        var preComputing = {\n            path: function (object) {\n                object.data.sort(function (a, b) {\n                    return a.x - b.x;\n                });\n                var level = addLevel(object.data);\n                object.data = object.data.map(function (d) {\n                    return [{\n                        x: d.x,\n                        y: 0,\n                        id: d.id,\n                        description: d.description,\n                        color: d.color\n                    }, {\n                        x: d.y,\n                        y: d.level + 1,\n                        id: d.id\n                    }, {\n                        x: d.y,\n                        y: 0,\n                        id: d.id\n                    }]\n                })\n                pathLevel = level * 10 + 5;\n                object.height = level * 10 + 5;\n            },\n            line: function (object) {\n                if (!object.height) object.height = 10;\n                var shift = parseInt(object.height);\n                var level = 0;\n                for (var i in object.data) {\n                    object.data[i].sort(function (a, b) {\n                        return a.x - b.x;\n                    });\n                    if (object.data[i][0].y !== 0) {\n                        object.data[i].unshift({\n                            x:object.data[i][0].x-1,\n                            y:0\n                        })\n                    }\n                    if (object.data[i][object.data[i].length -1].y !== 0){\n                        object.data[i].push({\n                            x:object.data[i][object.data[i].length -1].x+1,\n                            y:0\n                        })\n                    }\n                    var maxValue = Math.max.apply(Math,object.data[i].map(function(o){return Math.abs(o.y);}));\n                    level = maxValue > level ? maxValue : level;\n                    \n\n                    object.data[i] = [object.data[i].map(function (d) {\n                        return {\n                            x: d.x,\n                            y: d.y,\n                            id: d.id,\n                            description: d.description\n                        }\n                    })]\n                }\n                lineYscale.range([0, -(shift)]).domain([0, -(level)]);\n                pathLevel = shift * 10 +5;\n                object.level = level;\n                object.shift = shift * 10 +5;\n            },\n            multipleRect: function (object) {\n                object.data.sort(function (a, b) {\n                    return a.x - b.x;\n                });\n                level = addLevel(object.data);\n                pathLevel = level * 10 + 5;\n            }\n        };\n\n        var fillSVG = {\n            typeIdentifier: function (object) {\n                if (object.type === \"rect\") {\n                    preComputing.multipleRect(object);\n                    yData.push({\n                        title: object.name,\n                        y: Yposition,\n                        filter: object.filter\n                    });\n                    fillSVG.rectangle(object, Yposition);\n                } else if (object.type === \"text\") {\n                    fillSVG.sequence(object.data, Yposition);\n                    yData.push({\n                        title: object.name,\n                        y: Yposition,\n                        filter: object.filter\n                    });\n                    scaling.range([5, width-5]);\n                } else if (object.type === \"unique\") {\n                    fillSVG.unique(object, Yposition);\n                    yData.push({\n                        title: object.name,\n                        y: Yposition,\n                        filter: object.filter\n                    });\n                } else if (object.type === \"multipleRect\") {\n                    preComputing.multipleRect(object);\n                    fillSVG.multipleRect(object, Yposition, level);\n                    yData.push({\n                        title: object.name,\n                        y: Yposition,\n                        filter: object.filter\n                    });\n                    Yposition += (level - 1) * 10;\n                } else if (object.type === \"path\") {\n                    preComputing.path(object);\n                    fillSVG.path(object, Yposition);\n                    Yposition += pathLevel;\n                    yData.push({\n                        title: object.name,\n                        y: Yposition - 10,\n                        filter: object.filter\n                    });\n                } else if (object.type === \"line\") {\n                    if (!(Array.isArray(object.data[0]))) object.data = [object.data];\n                    if (!(Array.isArray(object.color))) object.color = [object.color];\n                    var negativeNumbers = false;\n                    object.data.forEach(function(d){\n                        if (d.filter(function(l){ return l.y < 0}).length) negativeNumbers = true;\n                    });\n                    preComputing.line(object);\n                    fillSVG.line(object, Yposition);\n                    Yposition += pathLevel;\n                    yData.push({\n                        title: object.name,\n                        y: Yposition - 10,\n                        filter: object.filter\n                    });\n                    Yposition += negativeNumbers ? pathLevel-5 : 0;\n                }\n            },\n            sequence: function (seq, position, start) {\n                //Create group of sequence\n                if (!start) var start = 0;\n\n                let seqSelected;\n\n                svgContainer.append(\"g\")\n                    .attr(\"class\", \"seqGroup\")\n                    .selectAll(\".AA\")\n                    .data(seq)\n                    .enter()\n                    .append(\"text\", function() {\n                        return d + '-' + i\n                    })\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"AA\")\n                    .attr(\"text-anchor\", \"middle\")\n                    .attr(\"x\", function (d, i) {\n                        return scaling.range([5, width-5])(i + start)\n                    })\n                    .attr(\"y\", position)\n                    .attr(\"font-size\", \"10px\")\n                    .attr(\"font-family\", \"monospace\")\n                    .text(function (d, i) {\n                        return d\n                    })\n                    .on(\"click\", function(e) {\n                        seqSelected = e;\n                        const width = $(window).width();\n                        const posX = this.getBoundingClientRect().x;\n\n                        const divPos = calculatePos(width, posX)\n                        showPopup(true, divPos)\n                    })\n                    \n                let optionsHeader = $(div + \" .svgHeader\").length ? d3.select(div + \" .svgHeader\") : d3.select(div).append(\"div\").attr(\"class\", \"svgHeader\");\n\n                let singlePopup = optionsHeader.append(\"div\") \n                    .attr(\"class\", \"single-variant-popup\")\n     \n                    singlePopup.append('svg')\n                    .attr(\"class\", \"cancel-icon\")\n                    .attr(\"height\", \"1.5rem\")\n                    .attr(\"width\", \"1.5rem\")                \n                    .attr(\"viewBox\",\"0 0 512 640\")\n                    .on(\"click\", function() {\n                        showPopup(false)\n                        $(`#single-dropdown-content`).hide()\n                    })\n                    .html(crossIcon)\n                 \n                    let popupContainer = singlePopup.append(\"div\")\n                    \n                    popupContainer.html(`\n                        <p>Enter the variants</p>\n                        <div class=\"properties-row\">\n                            <p class=\"title\">Position</p>\n                            <div class=\"single-variant-position\"></div>\n                        </div>\n                        <div class=\"properties-row\">\n                            <p class=\"title\">Original</p>\n                            <div class=\"single-variant-original\"></div>\n                        </div>\n                    `)\n\n                    const dropdown = popupContainer\n                    .append(\"div\")\n                    .attr(\"class\", \"properties-row\")\n\n                    dropdown.append(\"p\")\n                    .attr(\"class\", \"title\")\n                    .text(\"Variant\")\n\n                    let dropdownWrapper = dropdown.append(\"div\")\n                    .attr(\"class\", \"dropdown\")\n\n                    dropdownWrapper\n                    .append(\"button\")\n                    .attr(\"class\", \"dropdown-btn\")\n                    .attr(\"id\", \"single-variant-dropdown-btn\")\n                    .text(\"Select variant\")\n                    .on(\"click\", function() {\n                        $(`#single-dropdown-content`).toggle()\n                    })\n                    \n                    dropdownWrapper.append(\"div\")\n                    .attr(\"class\", \"bottom-arrow-icon\")\n                    .html(bottomArrowIcon)\n\n                    const dropdownContainer = dropdownWrapper.append(\"div\")\n                    .attr(\"id\", function() {\n                        return 'single-dropdown-content';\n                    })   \n\n                    popupContainer.append(\"button\")\n                    .attr(\"disabled\", true)\n                    .attr(\"class\", \"single-add-variant-btn\")\n                    .text(\"Add Variant\")\n                    .on(\"click\", function() {\n                        let value = $('#single-variant-dropdown-btn').text()\n                        addVariant(value)\n                    })\n                    \n                    dropdownContainer.append(\"input\")\n                    .attr(\"placeholder\", \"Search...\")\n                    .attr(\"id\", \"dropdown-search-input\")\n                    .on(\"keyup\", function() {\n                        let input, filter, p, i, div;\n                        input = document.getElementById(\"dropdown-search-input\");\n                        filter = input.value.toUpperCase();\n                        div = document.getElementById(\"dropdown-options\");\n                        p = div.getElementsByTagName(\"p\");\n\n                        p.map((_, i) => {\n                            let txtValue = p[i].textContent || p[i].innerText;\n                            if (txtValue.toUpperCase().indexOf(filter) > -1) {\n                              p[i].style.display = \"\";\n                            } else {\n                              p[i].style.display = \"none\";\n                            }\n                        })\n                    })\n\n                    let dropdownOptionContainer = dropdownContainer.append(\"div\")\n                                                .attr(\"class\", \"dropdown-option-container\")\n                                                .attr(\"id\", \"dropdown-options\")\n\n                    Object.entries(dropdownOptions).forEach(([key, value]) => {\n                        dropdownOptionContainer.append(\"p\")\n                        .attr(\"class\", \"single-dropdown-options\")\n                        .attr(\"id\", `${key} / ${value}`)\n                        .text(`${key} / ${value}`)\n                    })        \n                    \n                    $(document).on('click', '.single-dropdown-options', function () {\n                        const value = $(this).attr('id');\n                        $('#single-dropdown-content').hide()\n                        variantValue = value;\n                        $(this).parent().parent().parent().children('button').text(function() {\n                            return value\n                        });\n                        $(\".single-add-variant-btn\").attr('disabled', false);\n                    })\n\n                /**\n                 * Add variant and call onVariantChanged Event\n                 * @param {number} variantValue - Variant value\n                */\n\n                 function addVariant(variantValue) {\n                    if(variantValue === \"\") {\n                        console.log(\"Variant not added\")\n                        return;\n                    }\n                    let values = {};\n                    let position = $('.single-variant-position').text();\n\n                    values.position = Number(position);\n                    values['original-amino-acid'] = seqSelected;\n                    values['variant-amino-acid'] = variantValue.split(\" /\")[0];\n                    singleVariant.push(values)\n\n                    callOnVariantChanged()\n                 }\n\n                \n                /**\n                 * Show the single variant entry popup\n                 * @param {number} show - Show/hide the popup\n                 * @param {number} divPos - Position of popup \n                 */\n\n                function showPopup (show, divPos) {\n                    // reset default value\n                    $('#single-variant-dropdown-btn').text(\"Select variant\")\n                    variantValue = \"\";\n                    $(\".single-add-variant-btn\").attr('disabled', true);\n\n\n                    $(\".single-variant-position\").text(function() {\n                        return absoluteSeqPos\n                    })\n\n                    $(\".single-variant-original\").text(function() {\n                        return `${seqSelected} / ${dropdownOptions[seqSelected]}`\n                    })\n                    \n                    singlePopup\n                    .style(\"left\", `${divPos}px`)\n                    .style(\"display\", show ? \"block\" : \"none\")\n                }\n\n                 /**\n                 * Calculate the position of popup\n                 * @param {number} width - Screen width of client\n                 * @param {number} posX - Position of sequence clicked (in px)\n                 */\n\n                function calculatePos(width, posX) {\n                    const margin = 800;\n                    if(width - posX < margin) return width - (margin/2 + (width-posX));\n                    \n                    return posX;\n                }\n            },\n            sequenceLine: function () {\n                //Create line to represent the sequence\n                if (SVGOptions.dottedSequence){\n                    var dottedSeqLine = svgContainer.selectAll(\".sequenceLine\")\n                        .data([[{x:1,y:12},{x:fvLength,y:12}]])\n                        .enter()\n                        .append(\"path\")\n                        .attr(\"clip-path\", \"url(#clip)\")\n                        .attr(\"d\", line)\n                        .attr(\"class\",\"sequenceLine\")\n                        .style(\"z-index\", \"0\")\n                        .style(\"stroke\", \"black\")\n                        .style(\"stroke-dasharray\",\"1,3\")\n                        .style(\"stroke-width\", \"1px\")\n                        .style(\"stroke-opacity\",0);\n\n                    dottedSeqLine\n                        .transition()\n                        .duration(500)\n                        .style(\"stroke-opacity\", 1);\n                }\n            },\n            rectangle: function (object, position) {\n                //var rectShift = 20;\n                if (!object.height) object.height = 12;\n                var rectHeight = object.height;\n                \n                var rectShift = rectHeight + rectHeight/3;\n                var lineShift = rectHeight/2 - 6;\n//                var lineShift = rectHeight/2 - 6;\n\n                var rectsPro = svgContainer.append(\"g\")\n                    .attr(\"class\", \"rectangle\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n                \n                var dataline=[];\n                for (var i = 0; i < level; i++) {\n                    dataline.push([{\n                            x: 1,\n                            y: (i * rectShift + lineShift)\n                        }, {\n                            x: fvLength,\n                            y: (i * rectShift + lineShift)\n                        }]);\n                }\n                rectsPro.selectAll(\".line\" + object.className)\n                    .data(dataline)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"d\", line)\n                    .attr(\"class\", function () {\n                        return \"line\" + object.className\n                    })\n                    .style(\"z-index\", \"0\")\n                    .style(\"stroke\", object.color)\n                    .style(\"stroke-width\", \"1px\");\n\n\n                var rectsProGroup = rectsPro.selectAll(\".\" + object.className + \"Group\")\n                    .data(object.data)\n                    .enter()\n                    .append(\"g\")\n                    .attr(\"class\", object.className + \"Group\")\n                    .attr(\"transform\", function (d) {\n                        return \"translate(\" + rectX(d) + \",0)\"\n                    });\n\n                rectsProGroup\n                    .append(\"rect\")\n                    .attr(\"class\", \"element \" + object.className)\n                    .attr(\"id\", function (d) {\n                        return \"f\" + d.id\n                    })\n                    .attr(\"y\", function (d) {\n                        return d.level * rectShift\n                    })\n                    .attr(\"width\", rectWidth2)\n                    .attr(\"height\", rectHeight)\n                    .style(\"fill\", function(d) { return d.color || object.color })\n                    .style(\"z-index\", \"13\")\n                    .call(d3.helper.tooltip(object));\n\n                rectsProGroup\n                    .append(\"text\")\n                    .attr(\"class\", \"element \" + object.className + \"Text\")\n                    .attr(\"y\", function (d) {\n                        return d.level * rectShift + rectHeight/2\n                    })\n                    .attr(\"dy\", \"0.35em\")\n                    .style(\"font-size\", \"10px\")\n                    .text(function (d) {\n                        return d.description\n                    })\n                    .style(\"fill\", \"black\")\n                    .style(\"z-index\", \"15\")\n                    .style(\"visibility\", function (d) {\n                        if (d.description) {\n                            return (scaling(d.y) - scaling(d.x)) > d.description.length * 8 && rectHeight > 11 ? \"visible\" : \"hidden\";\n                        } else return \"hidden\";\n                    })\n                    .call(d3.helper.tooltip(object));\n\n\n                //rectsPro.selectAll(\".\" + object.className)\n                //    .data(object.data)\n                //    .enter()\n                //    .append(\"rect\")\n                //    .attr(\"clip-path\", \"url(#clip)\")\n                //    .attr(\"class\", \"element \"+object.className)\n                //    .attr(\"id\", function(d) { return \"f\"+d.id })\n                //    .attr(\"x\", X)\n                //    .attr(\"width\", rectWidth)\n                //    .attr(\"height\", 12)\n                //    .style(\"fill\", object.color)\n                //    .style(\"z-index\", \"13\")\n                //    .call(d3.helper.tooltip(object));\n\n                forcePropagation(rectsProGroup);\n                var uniqueShift = rectHeight > 12 ? rectHeight - 6 : 0;\n                Yposition += level < 2 ? uniqueShift : (level-1) * rectShift + uniqueShift;\n            },\n            unique: function (object, position) {\n                var rectsPro = svgContainer.append(\"g\")\n                    .attr(\"class\", \"uniquePosition\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n\n                var dataline=[];\n                dataline.push([{\n                        x: 1,\n                        y: 0\n                    }, {\n                        x: fvLength,\n                        y: 0\n                    }]);\n                \n                rectsPro.selectAll(\".line\" + object.className)\n                    .data(dataline)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"d\", line)\n                    .attr(\"class\", \"line\" + object.className)\n                    .style(\"z-index\", \"0\")\n                    .style(\"stroke\", object.color)\n                    .style(\"stroke-width\", \"1px\");\n\n                rectsPro.selectAll(\".\" + object.className)\n                    .data(object.data)\n                    .enter()\n                    .append(\"rect\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"element \" + object.className)\n                    .attr(\"id\", function (d) {\n                        return \"f\" + d.id\n                    })\n                    .attr(\"x\", function (d) {\n                        return scaling(d.x - 0.4)\n                    })\n                    .attr(\"width\", function (d) {\n                        if (scaling(d.x + 0.4) - scaling(d.x - 0.4) < 2) return 2;\n                        else return scaling(d.x + 0.4) - scaling(d.x - 0.4);\n                    })\n                    .attr(\"height\", 12)\n                    .style(\"fill\", function(d) {return d.color ||  object.color})\n                    .style(\"z-index\", \"3\")\n                    .call(d3.helper.tooltip(object));\n\n                forcePropagation(rectsPro);\n            },\n            path: function (object, position) {\n                var pathsDB = svgContainer.append(\"g\")\n                    .attr(\"class\", \"pathing\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n\n                var dataline=[];\n                dataline.push([{\n                        x: 1,\n                        y: 0\n                    }, {\n                        x: fvLength,\n                        y: 0\n                    }]);\n                \n                pathsDB.selectAll(\".line\" + object.className)\n                    .data(dataline)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"d\", lineBond)\n                    .attr(\"class\", \"line\" + object.className)\n                    .style(\"z-index\", \"0\")\n                    .style(\"stroke\", object.color)\n                    .style(\"stroke-width\", \"1px\");\n\n                pathsDB.selectAll(\".\" + object.className)\n                    .data(object.data)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"element \" + object.className)\n                    .attr(\"id\", function (d) {\n                        return \"f\" + d[0].id\n                    })\n                    .attr(\"d\", lineBond)\n                    .style(\"fill\", \"none\")\n                    .style(\"stroke\", function(d) {return d[0].color || object.color})\n                    .style(\"z-index\", \"3\")\n                    .style(\"stroke-width\", \"2px\")\n                    .call(d3.helper.tooltip(object));\n\n                forcePropagation(pathsDB);\n            },\n            line: function (object, position) {\n                if (!object.interpolation) object.interpolation = \"monotone\";\n                if (object.fill === undefined) object.fill = true;\n                var histog = svgContainer.append(\"g\")\n                    .attr(\"class\", \"lining\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n\n                var dataline=[];\n                dataline.push([{\n                        x: 1,\n                        y: 0\n                    }, {\n                        x: fvLength,\n                        y: 0\n                    }]);\n                \n                histog.selectAll(\".line\" + object.className)\n                    .data(dataline)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"d\", lineBond)\n                    .attr(\"class\", \"line\" + object.className)\n                    .style(\"z-index\", \"0\")\n                    .style(\"stroke\", \"black\")\n                    .style(\"stroke-width\", \"1px\");\n                object.data.forEach(function(dd,i,array){\n                    histog.selectAll(\".\" + object.className + i)\n                    .data(dd)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"element \" + object.className + \" \" + object.className + i)\n                    .attr(\"d\", lineGen.interpolate(object.interpolation))\n                    .style(\"fill\", object.fill ? shadeBlendConvert(0.6, object.color[i]) || shadeBlendConvert(0.6, \"#000\") : \"none\")\n                    .style(\"stroke\", object.color[i] || \"#000\")\n                    .style(\"z-index\", \"3\")\n                    .style(\"stroke-width\", \"2px\")\n//                    .style(\"shape-rendering\", \"crispEdges\")\n                    .call(d3.helper.tooltip(object));\n                })\n                \n                forcePropagation(histog);\n            },\n            multipleRect: function (object, position, level) {\n                var rectHeight = 8;\n                var rectShift = 10;\n                var rects = svgContainer.append(\"g\")\n                    .attr(\"class\", \"multipleRects\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n\n                for (var i = 0; i < level; i++) {\n                    rects.append(\"path\")\n                        .attr(\"d\", line([{\n                            x: 1,\n                            y: (i * rectShift - 2)\n                        }, {\n                            x: fvLength,\n                            y: (i * rectShift - 2)\n                        }]))\n                        .attr(\"class\", function () {\n                            return \"line\" + object.className\n                        })\n                        .style(\"z-index\", \"0\")\n                        .style(\"stroke\", object.color)\n                        .style(\"stroke-width\", \"1px\");\n                }\n\n                rects.selectAll(\".\" + object.className)\n                    .data(object.data)\n                    .enter()\n                    .append(\"rect\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"element \" + object.className)\n                    .attr(\"id\", function (d) {\n                        return \"f\" + d.id\n                    })\n                    .attr(\"x\", X)\n                    .attr(\"y\", function (d) {\n                        return d.level * rectShift\n                    })\n                    .attr(\"width\", rectWidth)\n                    .attr(\"height\", rectHeight)\n                    .style(\"fill\", function(d) { return d.color || object.color })\n                    .style(\"z-index\", \"13\")\n                    .call(d3.helper.tooltip(object));\n\n                forcePropagation(rects);\n            }\n        };\n\n        this.showFilteredFeature = function(className, color, baseUrl){\n\n            var featureSelected = yAxisSVG.selectAll(\".\"+className+\"Arrow\");\n            var minY = margin.left - 105;\n            var maxY = margin.left - 7;\n\n            var gradient = svg\n                .append(\"linearGradient\")\n                .attr(\"y1\", \"0\")\n                .attr(\"y2\", \"0\")\n                .attr(\"x1\", minY)\n                .attr(\"x2\", maxY)\n                .attr(\"id\", \"gradient\")\n                .attr(\"spreadMethod\", \"pad\")\n                .attr(\"gradientUnits\", \"userSpaceOnUse\");\n\n            gradient\n                .append(\"stop\")\n                .attr(\"offset\", \"0.3\")\n                .attr(\"stop-color\", \"#DFD5D3\")\n                .attr(\"stop-opacity\", 1);\n\n\n            var redgrad = gradient\n                .append(\"stop\")\n                .attr(\"offset\", \"1\")\n                .attr(\"stop-opacity\", 1)\n                .attr(\"stop-color\", \"#DFD5D3\");\n\n            redgrad\n                .attr(\"stop-color\", color);\n\n            var url_gradient = \"url(#gradient)\";\n            var url_dropshadow = \"url(#dropshadow)\";\n            if (baseUrl) {\n                url_gradient = \"url(\" + baseUrl + \"#gradient)\";\n                url_dropshadow = \"url(\" + baseUrl +\"#dropshadow)\";\n            }\n\n            var selection = yAxisSVG.selectAll(\".\"+className+\"Arrow\")\n                .style(\"fill\", url_gradient)\n                .style(\"stroke\", \"\")\n                .attr(\"filter\", url_dropshadow);\n            selection\n                .attr(\"points\", function (d) {\n                    return (margin.left - 105) + \",\" + (d.y - 3) + \", \" + (margin.left - 105) + \",\" + (d.y + 12) + \", \" + (margin.left - 10) + \",\" + (d.y + 12) + \", \" + (margin.left - 2) + \",\" + (d.y + 4.5) + \", \" + (margin.left - 10) + \",\" + (d.y -3); // x,y points\n                });\n        };\n        this.hideFilteredFeature = function(className){\n            yAxisSVG.selectAll(\".\"+className+\"Arrow\")\n                .style(\"fill\", \"rgba(95,46,38,0.2)\")\n                .attr(\"filter\", \"\")\n                .attr(\"points\", function (d) {\n                    return (margin.left - 105) + \",\" + (d.y - 3) + \", \" + (margin.left - 105) + \",\" + (d.y + 12) + \", \" + (margin.left - 15) + \",\" + (d.y + 12) + \", \" + (margin.left - 7) + \",\" + (d.y + 4.5) + \", \" + (margin.left - 15) + \",\" + (d.y -3); // x,y points\n                });\n        };\n\n        var transition = {\n            rectangle: function (object) {\n                svgContainer.selectAll(\".line\" + object.className)\n                    .attr(\"d\",line.x(function (d) {\n                    return scaling(d.x);\n                }));\n                var transit;\n                if (animation) {\n                    transit1 = svgContainer.selectAll(\".\" + object.className + \"Group\")\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                    transit2 = svgContainer.selectAll(\".\" + object.className)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit1 = svgContainer.selectAll(\".\" + object.className + \"Group\");\n                    transit2 = svgContainer.selectAll(\".\" + object.className);\n                }\n                transit1.attr(\"transform\", function (d) {\n                            return \"translate(\" + rectX(d) + \",0)\"\n                        });\n\n                transit2\n                    .attr(\"width\", rectWidth2);\n                svgContainer.selectAll(\".\" + object.className + \"Text\")\n                    .style(\"visibility\", function (d) {\n                        if (d.description) {\n                            return (scaling(d.y) - scaling(d.x)) > d.description.length * 8 && object.height > 11 ? \"visible\" : \"hidden\";\n                        } else return \"hidden\";\n                    });\n            },\n            multiRec: function (object) {\n                svgContainer.selectAll(\".\" + object.className)\n//                    .data(object.data)\n                    //.transition()\n                    //.duration(500)\n                    .attr(\"x\", function (d) {\n                        return scaling(d.x)\n                    })\n                    .attr(\"width\", function (d) {\n                        return scaling(d.y) - scaling(d.x)\n                    });\n            },\n            unique: function (object) {\n                svgContainer.selectAll(\".line\" + object.className)\n                    .attr(\"d\",line.x(function (d) {\n                    return scaling(d.x);\n                }));\n                var transit;\n                if (animation) {\n                    transit = svgContainer.selectAll(\".\" + object.className)\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit = svgContainer.selectAll(\".\" + object.className);\n                }\n                transit\n//                    .data(object.data)\n                    //.transition()\n                    //.duration(500)\n                    .attr(\"x\", function (d) {\n                        return scaling(d.x - 0.4)\n                    })\n                    .attr(\"width\", function (d) {\n                        if (scaling(d.x + 0.4) - scaling(d.x - 0.4) < 2) return 2;\n                        else return scaling(d.x + 0.4) - scaling(d.x - 0.4);\n                    });\n            },\n            path: function (object) {\n                svgContainer.selectAll(\".line\" + object.className)\n                    .attr(\"d\",lineBond.x(function (d) {\n                                            return scaling(d.x);\n                                        })\n                                      .y(function (d) {\n                                            return -d.y * 10 + object.height;\n                                        })\n                         );\n                var transit;\n                if (animation) {\n                    transit = svgContainer.selectAll(\".\" + object.className)\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit = svgContainer.selectAll(\".\" + object.className);\n                }\n                transit\n                    .attr(\"d\", lineBond.y(function (d) {\n                        return -d.y * 10 + object.height;\n                    }));\n            },\n            line: function (object) {\n                lineYscale.range([0, -(object.height)]).domain([0, -(object.level)]);\n                svgContainer.selectAll(\".line\" + object.className)\n                    .attr(\"d\", lineGen.y(function (d) {\n                        return lineYscale(-d.y) * 10 + object.shift;\n                    }));\n                var transit;\n                if (animation) {\n                    transit = svgContainer.selectAll(\".\" + object.className)\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit = svgContainer.selectAll(\".\" + object.className);\n                }\n                \n                transit\n                    .attr(\"d\", lineGen.y(function (d) {\n                        return lineYscale(-d.y) * 10 + object.shift;\n                    })\n                          .interpolate(object.interpolation)\n                         );\n            },\n            text: function (object, start) {\n                var transit;\n                if (animation) {\n                    transit = svgContainer.selectAll(\".\" + object.className)\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit = svgContainer.selectAll(\".\" + object.className);\n                }\n                transit\n                    .attr(\"x\", function (d, i) {\n                        return scaling(i + start)\n                    });\n            }\n        };\n\n        var brush = d3.svg.brush()\n            .x(scaling)\n            //.on(\"brush\", brushmove)\n            .on(\"brushend\", brushend);\n\n        function addBrush() {\n            svgContainer.append(\"g\")\n                .attr(\"class\", \"brush\")\n                .call(brush)\n                .selectAll(\"rect\")\n                .attr('height', Yposition + 50);\n        }\n        \n        this.zoom = function(start, end){\n            var zoomInside = current_extend.start<start && current_extend.end>end;\n            if (!zoomInside) {\n                svgContainer.selectAll(\".seqGroup\").remove();\n            }\n            brush.extent([start,end]);\n            brushend();\n        }\n        this.resetZoom = function(start, end){\n            resetAll();\n        }\n\n        function brushend() {\n            d3.select(div).selectAll('div.selectedRect').remove();\n            if (Object.keys(featureSelected).length !== 0 && featureSelected.constructor === Object) {\n                d3.select(featureSelected.id).style(\"fill\", featureSelected.originalColor);\n                featureSelected = {};\n                if (CustomEvent) {\n                    var event = new CustomEvent(self.events.FEATURE_DESELECTED_EVENT, {\n                        detail: {info:\"feature-deselected\"}\n                    });\n                    svgElement.dispatchEvent(event);\n                } else {\n                    console.warn(\"CustomEvent is not defined....\");\n                }\n                if (self.trigger) self.trigger(self.events.FEATURE_DESELECTED_EVENT, {info:\"feature-deselected\"});\n            }\n            // Check if brush is big enough before zooming\n            var extent = brush.extent();\n            var extentLength = Math.abs(extent[0] - extent[1]);\n\n            if (extent[0] < extent[1]) var start = parseInt(extent[0] - 1),\n                end = parseInt(extent[1] + 1);\n            else var start = parseInt(extent[1] + 1),\n                end = parseInt(extent[0] - 1);\n\n            var seq = displaySequence(extentLength);\n            if (!brush.empty() && extentLength > zoomMax) {\n                current_extend.length = extentLength;\n                var zoomScale = (fvLength / extentLength).toFixed(1);\n                $(div + \" .zoomUnit\").text(zoomScale.toString());\n                \n//                scaling.range([5,width-5]); \n                if (SVGOptions.showSequence && !(intLength) && seq && svgContainer.selectAll(\".AA\").empty()) {\n                    current_extend = { \n                    length : extentLength,\n                    start : start,\n                    end : end\n                    }\n                    seqShift = start;\n                    svgContainer.selectAll(\".sequenceLine\").remove();\n                    fillSVG.sequence(sequence.substring(start-1, end), 20, seqShift-1);\n                }\n\n                //modify scale\n//                scaling.range([5,width-5]);\n                scaling.domain(extent);\n                scalingPosition.range(extent);\n                var currentShift = seqShift ? seqShift : offset.start;\n                \n\n                transition_data(features, currentShift);\n                reset_axis();\n\n                if (CustomEvent) {\n                  svgElement.dispatchEvent(new CustomEvent(\n                    self.events.ZOOM_EVENT,\n                    {detail: { start: start, end: end, zoom: zoomScale }}\n                    ));\n                }\n                if (self.trigger) self.trigger(self.events.ZOOM_EVENT, {\n                            start: start,\n                            end: end,\n                            zoom: zoomScale\n                        });\n\n                //rectsPep2.classed(\"selected\", false);\n                d3.select(div).selectAll(\".brush\").call(brush.clear());\n            } else {\n                d3.select(div).selectAll(\".brush\").call(brush.clear());\n                //resetAll();\n            }\n        }\n//        \n        var resizeCallback = function(){\n            \n            updateWindow();\n        }\n        \n        $(window).on(\"resize\", resizeCallback);\n        \n        function updateWindow(){\n//            var new_width = $(div).width() - margin.left - margin.right - 17;\n//            var width_larger = (width < new_width);\n            \n            width = $(div).width() - margin.left - margin.right - 17;\n            d3.select(div+\" svg\")\n                .attr(\"width\", width + margin.left + margin.right);\n            d3.select(div+\" #clip>rect\").attr(\"width\", width);\n            if (SVGOptions.brushActive) {\n                d3.select(div+\" .background\").attr(\"width\", width);\n            }\n            d3.select(div).selectAll(\".brush\").call(brush.clear());\n            \n//            var currentSeqLength = svgContainer.selectAll(\".AA\").size();\n            var seq = displaySequence(current_extend.length);\n            if (SVGOptions.showSequence && !(intLength)){\n                if (seq === false && !svgContainer.selectAll(\".AA\").empty()) {\n                    svgContainer.selectAll(\".seqGroup\").remove();\n                    fillSVG.sequenceLine();\n                }\n                else if (seq === true && svgContainer.selectAll(\".AA\").empty()){\n                    svgContainer.selectAll(\".sequenceLine\").remove();\n                    fillSVG.sequence(sequence.substring(current_extend.start-1, current_extend.end), 20, current_extend.start-1);\n                    \n                }\n            }\n            \n            scaling.range([5,width-5]);\n            scalingPosition.domain([0, width]);\n            \n            transition_data(features, current_extend.start);\n            reset_axis();\n            \n        }\n\n        // If brush is too small, reset view as origin\n        function resetAll() {\n\n            //reset scale\n\n            $(\".zoomUnit\").text(\"1\");\n            scaling.domain([offset.start, offset.end]);\n            scalingPosition.range([offset.start, offset.end]);\n            var seq = displaySequence(offset.end - offset.start);\n            \n            if (SVGOptions.showSequence && !(intLength)){\n                if (seq === false && !svgContainer.selectAll(\".AA\").empty()){\n                    svgContainer.selectAll(\".seqGroup\").remove();\n                    fillSVG.sequenceLine();\n                }\n                else if (current_extend.length !== fvLength && seq === true && !svgContainer.selectAll(\".AA\").empty()) {\n                    svgContainer.selectAll(\".seqGroup\").remove();\n                    fillSVG.sequence(sequence.substring(offset.start-1,offset.end), 20, offset.start);\n                }\n            }\n\n            current_extend={ \n                    length : offset.end-offset.start,\n                    start : offset.start,\n                    end : offset.end\n                };\n            seqShift=0;\n            \n            transition_data(features, offset.start);\n            reset_axis();\n\n            // Fire Event\n            if (CustomEvent) {\n              svgElement.dispatchEvent(new CustomEvent(self.events.ZOOM_EVENT,\n                { detail: { start: 1, end: sequence.length, zoom: 1 }}));\n            };\n            if (self.trigger) self.trigger(self.events.ZOOM_EVENT, {\n                            start: 1,\n                            end: sequence.length,\n                            zoom: 1\n                        });\n\n            d3.select(div).selectAll(\".brush\").call(brush.clear());\n        }\n\n        function transition_data(features, start) {\n            features.forEach(function (o) {\n                if (o.type === \"rect\") {\n                    transition.rectangle(o);\n                } else if (o.type === \"multipleRect\") {\n                    transition.multiRec(o);\n                } else if (o.type === \"unique\") {\n                    transition.unique(o);\n                } else if (o.type === \"path\") {\n                    transition.path(o);\n                } else if (o.type === \"line\") {\n                    transition.line(o);\n                } else if (o.type === \"text\") {\n                    transition.text(o, start);\n                }\n            });\n        }\n\n        /** export to new axis file? */\n        function reset_axis() {\n            svgContainer\n                .transition().duration(500)\n                .select(\".x.axis\")\n                .call(xAxis);\n        }\n\n        function addVerticalLine() {\n            var vertical = d3.select(\".chart\")\n                .append(\"div\")\n                .attr(\"class\", \"Vline\")\n                .style(\"position\", \"absolute\")\n                .style(\"z-index\", \"19\")\n                .style(\"width\", \"1px\")\n                .style(\"height\", (Yposition + 50) + \"px\")\n                .style(\"top\", \"30px\")\n                // .style(\"left\", \"0px\")\n                .style(\"background\", \"#000\");\n\n            d3.select(\".chart\")\n                .on(\"mousemove.Vline\", function () {\n                    mousex = d3.mouse(this)[0] - 2;\n                    vertical.style(\"left\", mousex + \"px\")\n                });\n            //.on(\"click\", function(){\n            //    mousex = d3.mouse(this);\n            //    mousex = mousex[0] + 5;\n            //    vertical.style(\"left\", mousex + \"px\")});\n        }\n\n        this.addRectSelection = function (svgId) {\n            var featSelection = d3.select(svgId);\n            var elemSelected = featSelection.data();\n            var xTemp;\n            var yTemp;\n            var xRect;\n            var widthRect;\n            var svgWidth = SVGOptions.brushActive ? d3.select(\".background\").attr(\"width\") : svgContainer.node().getBBox().width;\n            d3.select('body').selectAll('div.selectedRect').remove();\n\n            var objectSelected = {type:featSelection[0][0].tagName, color:featSelection.style(\"fill\")};\n            colorSelectedFeat(svgId, objectSelected);\n\n            // Append tooltip\n            var selectedRect = d3.select(div)\n                .append('div')\n                .attr('class', 'selectedRect');\n\n            if (elemSelected[0].length === 3) {\n                xTemp = elemSelected[0][0].x;\n                yTemp = elemSelected[0][1].x;\n            } else if (elemSelected[0].x === elemSelected[0].y) {\n                xTemp = elemSelected[0].x - 0.5;\n                yTemp = elemSelected[0].y + 0.5;\n            } else {\n                xTemp = elemSelected[0].x;\n                yTemp = elemSelected[0].y;\n            }\n            if (scaling(xTemp) < 0) {\n                xRect = margin.left;\n                widthRect = (scaling(yTemp));\n            } else if (scaling(yTemp) > svgWidth) {\n                xRect = scaling(xTemp) + margin.left;\n                widthRect = svgWidth - scaling(xTemp);\n            } else {\n                xRect = scaling(xTemp) + margin.left;\n                widthRect = (scaling(yTemp) - scaling(xTemp));\n            }\n            selectedRect.style({\n                left: xRect + 'px',\n                top: 60 + 'px',\n                'background-color': 'rgba(0, 0, 0, 0.2)',\n                width: widthRect + 'px',\n                height: (Yposition + 50) + 'px',\n                position: 'absolute',\n                'z-index': -1,\n                'box-shadow': '0 1px 2px 0 #656565'\n            });\n        };\n\n        function initSVG(div, options) {\n\n            if (typeof options === 'undefined') {\n                var options = {\n                    'showAxis': false,\n                    'showSequence': false,\n                    'brushActive': false,\n                    'verticalLine': false,\n                    'toolbar': false,\n                    'bubbleHelp': false,\n                    'unit': \"units\",\n                    'zoomMax': 50\n                }\n            }\n\n            if (!$.fn.popover) {\n                options.bubbleHelp = false;\n                console.warn(\"The bubble help requires tooltip and popover bootstrap js libraries. The feature viewer will continue to work, but without the info bubble\");\n            }\n\n            // Create SVG\n            if (options.zoomMax) {\n                zoomMax = options.zoomMax;\n            }\n            if (!options.unit) {\n                options.unit = \"units\";\n            }\n            if (options.animation) {\n                animation = options.animation;\n            }\n\n            if (options.toolbar === true) {\n                \n                var headerOptions = $(div + \" .svgHeader\").length ? d3.select(div + \" .svgHeader\") : d3.select(div).append(\"div\").attr(\"class\", \"svgHeader\");\n                \n//                if (options.toolbarTemplate && options.toolbarTemplate === 2) {\n\n                    if (!$(div + ' .header-position').length) {\n                        var headerPosition = headerOptions\n                            .append(\"div\")\n                            .attr(\"class\", \"header-position\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"margin\", \"15px 10px 0px\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"line-height\",\"32px\");\n                        headerPosition\n                            .append(\"div\")\n                            .attr(\"class\", \"position-label\")\n                            .style(\"padding\", \"0px 5px\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"font-weight\",\"700\")\n                            .text(\"Position  :  \");\n                        headerPosition\n                            .append(\"div\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"padding-left\", \"5px\")\n                            .append(\"div\")\n                            .style(\"min-width\",\"50px\")\n                            .attr(\"id\", \"zoomPosition\")\n                            .text(\"0\");\n                    }\n                    if (!$(div + ' .header-zoom').length) {\n                        var headerZoom = headerOptions\n                            .append(\"div\")\n                            .attr(\"class\", \"header-zoom\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"margin\", \"15px 0px 0px\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"line-height\",\"32px\");\n                        headerZoom\n                            .append(\"div\")\n                            .attr(\"class\", \"zoom-label\")\n                            .style(\"padding\", \"0px 5px\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"font-weight\",\"700\")\n                            .text(\"Zoom : \");\n\n                        headerZoom\n                            .append(\"div\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"padding\", \"0px\")\n                            .append(\"div\")\n                            .style(\"min-width\",\"50px\")\n                            .style(\"padding-left\", \"5px\")\n                            .append(\"span\")\n                            .text(\"x \")\n                            .append(\"span\")\n                            .attr(\"class\", \"zoomUnit\")\n                            .text(\"1\");\n                    }\n//                }\n//                else{\n//                    if (!$(div + ' .header-zoom').length) {\n//                        var headerZoom = headerOptions\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel panel-default header-zoom\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"width\", \"150px\")\n//                            .style(\"margin\", \"20px 0px 0px\")\n//                            .style(\"padding\", \"0px\");\n//                        headerZoom\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel-heading\")\n//                            .style(\"padding\", \"0px 15px\")\n//                            .style(\"border-right\", \"1px solid #DDD\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"width\", \"80px\")\n//                            .append(\"h5\")\n//                            .style(\"padding\", \"0px\")\n//                            .style(\"height\", \"10px\")\n//                            .style(\"color\", \"#777\")\n//                            .text(\"ZOOM\");\n//                        headerZoom\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel-body\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"padding\", \"0px\")\n//                            .append(\"h5\")\n//                            .style(\"padding-left\", \"15px\")\n//                            .style(\"height\", \"10px\")\n//                            .text(\"x \")\n//                            .append(\"span\")\n//                            .attr(\"class\", \"zoomUnit\")\n//                            .text(\"1\");\n//                    }\n//                    if (!$(div + ' .header-position').length) {\n//                        var headerPosition = headerOptions\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel panel-default header-position\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"width\", \"175px\")\n//                            .style(\"margin\", \"20px 20px 0px\")\n//                            .style(\"padding\", \"0px\");\n//                        headerPosition\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel-heading\")\n//                            .style(\"padding\", \"0px 15px\")\n//                            .style(\"border-right\", \"1px solid #DDD\")\n//                            .style(\"display\", \"inline-block\")\n//                            .append(\"h5\")\n//                            .style(\"padding\", \"0px\")\n//                            .style(\"height\", \"10px\")\n//                            .style(\"color\", \"#777\")\n//                            .text(\"POSITION\");\n//                        headerPosition\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel-body\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"padding\", \"0px\")\n//                            .append(\"h5\")\n//                            .style(\"padding-left\", \"15px\")\n//                            .style(\"height\", \"10px\")\n//                            .append(\"span\")\n//                            .attr(\"id\", \"zoomPosition\")\n//                            .text(\"0\");\n//                    }\n//                }\n                var headerZoom = $(div + ' .header-zoom').length ? d3.select(div + ' .header-zoom') : headerOptions;\n                if (options.bubbleHelp === true) {\n                    if (!$(div + ' .header-help').length) {\n                        var helpContent = \"<div><strong>To zoom in :</strong> Left click to select area of interest</div>\" +\n                            \"<div><strong>To zoom out :</strong> Right click to reset the scale</div>\" +\n                            \"<div><strong>Zoom max  :</strong> Limited to <strong>\" + zoomMax.toString() + \" \" + options.unit +\"</strong></div>\";\n//                        var headerHelp = headerOptions\n                        var headerHelp = headerZoom\n                            .append(\"div\")\n//                            .insert(\"div\",\":first-child\")\n//                            .attr(\"class\", \"pull-right\")\n                            .style(\"display\", \"inline-block\")\n//                            .style(\"margin\", \"15px 35px 0px 0px\")\n                            .style(\"margin\", \"0px\")\n                            .style(\"margin-right\", \"5px\")\n//                            .style(\"line-height\",\"32px\")\n                            .style(\"padding\", \"0px\");\n                        var buttonHelp = headerHelp\n                            .append(\"a\")\n                            .attr(\"type\", \"button\")\n                            .attr(\"class\", \"header-help\")\n                            .attr(\"data-toggle\", \"popover\")\n                            .attr(\"data-placement\", \"auto left\")\n                            .attr(\"title\", \"Help\")\n                            .attr(\"data-content\", helpContent)\n                            .style(\"font-size\", \"14px\");\n//                            .style(\"margin-bottom\", \"2px\");\n                        buttonHelp\n                            .append(\"span\")\n                            .attr(\"class\", \"label label-as-badge label-info\")\n                            .style(\"font-weight\",\"500\")\n//                            .style(\"border-radius\",\"3px\")\n                            .style(\"border-radius\",\"3px\")\n//                            .style(\"background-color\",\"#f8f8f8\")\n//                            .style(\"background-color\",\"#108D9F\")\n//                            .style(\"border\",\"1px solid #ddd\")\n//                            .style(\"border\",\"1px solid #0C6B78\")\n//                            .style(\"color\",\"#777\")\n                            .style(\"box-shadow\",\"inset 0px 0px 4px rgba(0,0,0,0.10)\")\n                            .style(\"color\",\"#fff\")\n//                            .style(\"padding\",\"2px 6px\")\n                            .html(\"<span class='state'>Show</span> help\");\n                        $(function () {\n                            $('[data-toggle=\"popover\"]').popover({html: true});\n                            $(div + ' .header-help').on('hide.bs.popover', function () {\n                              $(this).find(\".state\").text(\"Show\");\n                            });\n                            $(div + ' .header-help').on('show.bs.popover', function () {\n                              $(this).find(\".state\").text(\"Hide\");\n                            });\n                        })\n                    }\n                }\n            }\n                    if (!$(div + ' .variantHeader').length) {\n\n                        const optionsHeader = $(div + \" .svgHeader\").length ? d3.select(div + \" .svgHeader\") : d3.select(div).append(\"div\").attr(\"class\", \"svgHeader\");\n\n                        const multipleVariantContainer = optionsHeader\n                                                    .append(\"div\")\n                                                    .style(\"position\", \"relative\")\n                                                    .style(\"display\",\"flex\")\n                                                    .style(\"column-gap\", \"1rem\")\n\n                        let showMultipleVariantPopup = true;\n                        let inputCount = 0;\n\n                        multipleVariantContainer\n                            .append(\"span\")\n                            .attr(\"class\", \"add-variant-btn\")\n                            .style(\"margin-left\", \"auto\")\n                            .text(\"+ Add Multiple Variants\")\n                            .on(\"click\", function() {\n                                multipleVariantPopup(showMultipleVariantPopup)\n                                if(multipleVariant.length === 0) {\n                                    appendInputFields()\n                                } \n                                showMultipleVariantPopup = !showMultipleVariantPopup\n                            })\n\n\n                        const popup = multipleVariantContainer\n                            .append(\"div\")\n                            .attr(\"class\", \"multiple-variant-popup\")\n                            \n                            \n                        popup.html(`<p>Enter the variants</p><div class=\"header\"><input type=\"checkbox\" id=\"select-all-variant\" />${deleteIcon}<p>Position</p><p>Original</p><p>Variant</p></div>`)\n\n                        $('.delete-icon').on(\"click\", function() {\n                                    $(\".input-wrapper input:checkbox\").each(function(){\n                                        var $this = $(this);\n                                        if($this.is(\":checked\")){\n                                            let id = $(this).attr('id')\n                                            $this.parent().remove()\n                                            const variantIndex = multipleVariant.findIndex(m => m.id == id)\n                                            multipleVariant.splice(variantIndex, 1)\n                                        }\n                                    });\n\n                                    if(multipleVariant.length === 0) {\n                                        inputCount = 0;\n                                        const variantValues = { id: inputCount, position: \"\", 'original-amino-acid': \"\", 'variant-amino-acid': \"\" }\n                                        multipleVariant.push(variantValues)\n                                        appendInputFields();\n                                    } \n                                    callOnVariantChanged()\n                                })\n                                \n                                $('#select-all-variant').on(\"click\", function() {\n                                    $('.input-wrapper input:checkbox').prop('checked', this.checked); \n                                })\n\n                            popup.append('svg')\n                                .attr(\"height\", \"1.5rem\")\n                                .attr(\"width\", \"1.5rem\")\n                                .attr(\"class\", \"cancel-icon\")\n                                .on(\"click\", function() {\n                                    showMultipleVariantPopup = !showMultipleVariantPopup\n                                    multipleVariantPopup(false)\n                                })\n                                .attr(\"viewBox\",\"0 0 500 620\")\n                                .html(crossIcon)\n                        \n                        const inputContainer = popup\n                            .append(\"div\")\n                            .attr(\"class\", \"input-container\")\n\n                        /**\n                         * Updates the values of multiple variant entry popup\n                         * @param {number} value - Position of amino acid/variant amino acid value\n                         * @param {string} type - \"Position\" || \"Variant\"\n                         * @param {number} idx - Index of multipleVariant to be updated\n                         */\n\n                        function updateInputValues(value, type, idx) {\n                            const variantIndex = multipleVariant.findIndex(m => m.id == idx);\n                            value = value.split(\" /\")[0];\n                            switch(type) {\n                                case \"position\": \n                                                let originalValue = sequence.charAt(Number(value)-1);\n                                                multipleVariant[variantIndex].position = Number(value);\n                                                multipleVariant[variantIndex]['original-amino-acid'] = originalValue;\n                                                $(`#${idx}-original`).text(function() {\n                                                    return `${originalValue} / ${dropdownOptions[originalValue]}`\n                                                });\n                                                break;\n                                case \"variant\": multipleVariant[variantIndex]['variant-amino-acid'] = value;\n                                                break;\n                            }\n                        }\n\n                        /**\n                         * Add input fields to multiple variant entry popup\n                         */\n\n                        function appendInputFields() {\n                            $('#multiple-add-variant-btn').attr(\"disabled\", true)\n\n                            const variantValues = { id: inputCount, position: \"\", 'original-amino-acid': \"\", 'variant-amino-acid': \"\" }\n                            multipleVariant.push(variantValues)\n\n\n                            const inputWrapper = inputContainer.append(\"div\").attr(\"class\", \"input-wrapper\")\n                            \n                            inputWrapper.append(\"input\")\n                            .attr(\"type\", \"checkbox\")\n                            .attr(\"class\", \"input-checkbox\")\n                            .attr(\"id\", function() {\n                                return inputCount;\n                            })\n\n                            inputWrapper\n                            .append(\"input\")\n                            .attr(\"class\", \"popup-input\")   \n                            .attr(\"maxlength\", \"5\")\n                            .attr(\"id\", function() {\n                                return inputCount + '-position';\n                            })\n                            .attr(\"value\", function(d, i) {\n                                return i;\n                            })\n                            .on(\"change\", function(d) {\n                                const value = d3.select(this).property(\"value\");\n                                if(value > sequence.length) return\n                                d3.select(this).attr(\"value\", value)\n                                var idx = d3.select(this).property(\"id\").split(\"-\")[0]\n                                updateInputValues(value, \"position\", idx)\n                                validateInput()\n                            });\n\n                            \n                            inputWrapper\n                            .append(\"span\")\n                            .attr(\"id\", function() {\n                                return inputCount + '-original';\n                            })\n                            .attr(\"class\", \"original-input\")\n                            .text(\"0\")      \n                            \n                            const dropdown = inputWrapper\n                            .append(\"div\")\n                            .attr(\"class\", \"dropdown\")\n                            \n                            dropdown\n                            .append(\"button\")\n                            .attr(\"class\", \"dropdown-btn\")\n                            .attr(\"id\", function() {\n                                return inputCount + '-variant';\n                            })  \n                            .text(\"Select variant\")\n                            .on(\"click\", function() {\n                                let id = $(this).attr('id');\n                                $(\"div.dropdown-content\").not(`#${id}-dropdown`).hide();\n                                $(`#${id}-dropdown`).toggle()\n                            })\n                            \n                            dropdown.append(\"div\")\n                            .attr(\"class\", \"bottom-arrow-icon\")\n                            .html(bottomArrowIcon)\n\n                            const dropdownContainer = dropdown.append(\"div\")\n                            .attr(\"id\", function() {\n                                return inputCount + '-variant-dropdown';\n                            })   \n                            .attr(\"class\", \"dropdown-content\")\n                            \n                            dropdownContainer.append(\"input\")\n                            .attr(\"placeholder\", \"Search...\")\n                            .attr(\"id\", \"dropdown-search-input\")\n                            .on(\"keyup\", function() {\n                                var input, filter, p, i, div;\n                                input = document.getElementById(\"dropdown-search-input\");\n                                filter = input.value.toUpperCase();\n                                div = document.getElementById(\"dropdown-options\");\n                                p = div.getElementsByTagName(\"p\");\n\n                                p.map((_, i) => {\n                                    let txtValue = p[i].textContent || p[i].innerText;\n                                    if (txtValue.toUpperCase().indexOf(filter) > -1) {\n                                      p[i].style.display = \"\";\n                                    } else {\n                                      p[i].style.display = \"none\";\n                                    }\n                                })\n                            })\n\n                            let dropdownOptionContainer = dropdownContainer.append(\"div\")\n                            .attr(\"class\", \"dropdown-option-container\")\n                            .attr(\"id\", \"dropdown-options\")\n\n                            Object.entries(dropdownOptions).forEach(([key, value]) => {\n                                dropdownOptionContainer.append(\"p\")\n                                .attr(\"class\", \"dropdown-options\")\n                                .attr(\"id\", `${key} / ${value}`)\n                                .text(`${key} / ${value}`)\n                            })\n                            inputCount++;\n                        }\n\n                         /**\n                         * Check if input values are not null before adding next set of input fields\n                         */\n\n                        function validateInput(){\n                            const lastSelectValue = $('.input-container').children(\":last\").children(\":last\").children(\":first\").text();\n                            const lastInputValue = $('.input-container').children(\":last\").children(\".popup-input\").attr(\"value\");\n                           \n                            if(lastSelectValue == \"\" || lastSelectValue == \"Select variant\" || lastInputValue == 0) {\n                                return false;\n                            } \n                            $('#multiple-add-variant-btn').attr(\"disabled\", false);\n                            return true;\n                        }\n\n                        $(document).on('click', '.dropdown-options', function () {\n                            const value = $(this).attr('id');\n                            $('.dropdown-content').hide()\n                            \n                            const id = $(this).parent().parent().attr(\"id\")\n                            const index = id.split('-')[0];\n                            $(this).parent().parent().parent().children('button').text(function() {\n                                return value\n                            });\n                            \n                            updateInputValues(value, \"variant\", index)\n                            validateInput()\n                        })\n\n                        const btnContainer = popup.append(\"div\")\n                                                .attr(\"class\", \"multiple-variant-btn-container\")\n\n                        btnContainer\n                                .append(\"button\")\n                                .attr(\"class\", \"add-variant-btn\")\n                                .attr(\"id\", \"multiple-add-variant-btn\")\n                                .attr(\"disabled\", true)\n                                .text(\"+\")\n                                .on(\"click\", function() {\n                                    if(!validateInput()) return;\n                                    callOnVariantChanged()\n                                    appendInputFields()\n                                })\n                            \n                        btnContainer\n                                .append(\"span\")\n                                .text(\"Get Predictions\")\n                                .attr(\"class\", \"get-predictions-btn\")\n                                .on(\"click\", function() {\n                                    callOnGetPredictions();\n                                })\n\n                        function multipleVariantPopup(showPopup) {\n                            popup\n                            .style(\"display\", showPopup ? \"block\" : \"none\")\n                        }\n\n                        multipleVariantContainer\n                        .append(\"span\")\n                            .attr(\"class\", \"get-predictions-btn\")\n                            .text(\"Get Predictions\")\n                            .on(\"click\", function() {\n                               callOnGetPredictions();\n                            })\n                    }\n            \n            \n            svg = d3.select(div).append(\"svg\")\n                .attr(\"width\", width + margin.left + margin.right)\n                .attr(\"height\", height + margin.top + margin.bottom)\n                .style(\"z-index\", \"2\")\n                .on(\"contextmenu\", function (d, i) {\n                    d3.event.preventDefault();\n                    resetAll();\n                    // react on right-clicking\n                });\n            svgElement = el.getElementsByTagName(\"svg\")[0];\n\n\n            svgContainer = svg\n                .append(\"g\")\n                .attr(\"id\", \"svg-container\")\n                .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n            //Create Clip-Path\n            var defs = svgContainer.append(\"defs\");\n\n            defs.append(\"clipPath\")\n                .attr(\"id\", \"clip\")\n                .append(\"rect\")\n                .attr(\"width\", width)\n                .attr(\"height\", height);\n\n            var filter = defs.append(\"filter\")\n                .attr(\"id\", \"dropshadow\")\n                .attr(\"height\", \"200%\");\n\n            filter.append(\"feGaussianBlur\")\n                .attr(\"in\", \"SourceAlpha\")\n                .attr(\"stdDeviation\", 3)\n                .attr(\"result\", \"blur\");\n            filter.append(\"feOffset\")\n                .attr(\"in\", \"blur\")\n                .attr(\"dx\", -2)\n                .attr(\"dy\", 2)\n                .attr(\"result\", \"offsetBlur\");\n\n            var feMerge = filter.append(\"feMerge\");\n\n            feMerge.append(\"feMergeNode\")\n                .attr(\"in\", \"offsetBlur\");\n            feMerge.append(\"feMergeNode\")\n                .attr(\"in\", \"SourceGraphic\");\n\n            svgContainer.on('mousemove', function () {\n                let absoluteMousePos = SVGOptions.brushActive ? d3.mouse(d3.select(\".background\").node()) : d3.mouse(svgContainer.node());;          \n                seqPos = Math.round(scalingPosition(absoluteMousePos[0]));\n                absoluteSeqPos = seqPos;\n                if (!options.positionWithoutLetter) {\n                    seqPos += sequence[seqPos-1] || \"\";\n                }\n                $(div + \" #zoomPosition\").text(seqPos);\n            });\n            \n            if (typeof options.dottedSequence !== \"undefined\"){\n                SVGOptions.dottedSequence = options.dottedSequence;\n            }\n            if (options.showSequence && !(intLength)) {\n                SVGOptions.showSequence = true;\n                if (displaySequence(offset.end - offset.start)) {\n                    fillSVG.sequence(sequence.substring(offset.start-1, offset.end), Yposition, offset.start);\n                }\n                else{\n                    fillSVG.sequenceLine();\n                }\n                features.push({\n                    data: sequence,\n                    name: \"Sequence\",\n                    className: \"AA\",\n                    color: \"black\",\n                    type: \"text\"\n                });\n                yData.push({\n                    title: \"Sequence\",\n                    y: Yposition - 8\n                });\n            }\n            if (options.showAxis) addXAxis(Yposition);\n            addYAxis();\n            if (options.brushActive) {\n                SVGOptions.brushActive = true;\n                zoom = true;\n                addBrush();\n            }\n            if (options.verticalLine) {\n                SVGOptions.verticalLine = true;\n                addVerticalLine();\n            }\n\n            updateSVGHeight(Yposition);\n\n        }\n\n        initSVG(div, options);\n\n        // Workaround for re-ordering svg <g> element\n        $('.seqGroup').appendTo($('#svg-container'));\n\n        /**\n        * Calls onVariantChanged Custom Event\n        */\n        function callOnVariantChanged() {\n            let values = multipleVariant;\n            if(values.length > 0) {\n                const lastValue = values.length-1;\n                if(values[lastValue]['original-amino-acid'] == \"\" || values[lastValue]['variant-amino-acid'] == \"\") {\n                    values.splice(lastValue, 1);\n                }\n            }\n\n            values = [...values, ...singleVariant];\n\n            if (CustomEvent) {\n                svgElement.dispatchEvent(new CustomEvent(\n                  self.events.VARIANT_ADDED_EVENT,  \n                  {detail: values}\n                  ));\n              }\n              if (self.trigger) self.trigger(self.events.VARIANT_ADDED_EVENT, \n                values\n            ); \n        }\n        \n\n        /**\n        * Calls onGetPredictions Custom Event\n        */\n        function callOnGetPredictions() {\n            let values = multipleVariant.map(({id,...rest}) => ({...rest}));\n            if(values.length > 0) {\n                const lastValue = values.length-1;\n                if(values[lastValue]['original-amino-acid'] == \"\" || values[lastValue]['variant-amino-acid'] == \"\") {\n                    values.splice(lastValue, 1);\n                }\n            }\n\n            values = [...values, ...singleVariant];\n            \n            if (CustomEvent) {\n                svgElement.dispatchEvent(new CustomEvent(\n                self.events.GET_PREDICTIONS_EVENT,\n                { detail: values }\n                ));\n            }\n            if (self.trigger) self.trigger(self.events.GET_PREDICTIONS_EVENT, \n                values\n                );\n          }\n\n        this.addFeature = function (object) {\n            Yposition += 20;\n            features.push(object);\n            fillSVG.typeIdentifier(object);\n            updateYaxis();\n            updateXaxis(Yposition);\n            updateSVGHeight(Yposition);\n            if (SVGOptions.brushActive) {\n                svgContainer.selectAll(\".brush rect\")\n                    .attr('height', Yposition + 50);\n            }\n            if (SVGOptions.verticalLine) d3.selectAll(\".Vline\").style(\"height\", (Yposition + 50) + \"px\");\n            if (d3.selectAll(\".element\")[0].length > 1500) animation = false;\n\n        }\n        \n        this.clearInstance = function (){\n            $(window).off(\"resize\", resizeCallback);\n            svg = null;\n            svgElement = null;\n            svgContainer = null;\n            yAxisSVGgroup = null;\n            yAxisSVG = null;\n            features = null;\n            sbcRip = null;\n            d3.helper = {};\n        }\n    }\n\nif ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\n    module.exports = createFeature;\n}","const crossIcon = `    <svg\nxmlns=\"http://www.w3.org/2000/svg\"\nwidth=\"512\"\nheight=\"512\"\nfill=\"none\"\nviewBox=\"0 0 512 512\"\n>\n<path fill=\"#7D7D7D\" d=\"M94 101H405V382H94z\"></path>\n<path\n  fill=\"#DFDFDF\"\n  d=\"M256 0C114.61 0 0 114.61 0 256s114.61 256 256 256c141.38 0 256-114.61 256-256S397.39 0 256 0zm87.72 307c13.06 12.28 17.61 26.86 4.11 40.55-13.5 13.69-28 9.52-40.57-3.41l-52.08-53.6c-18.33 19.5-34.31 36.71-50.52 53.69-12.47 13.07-27.19 16.91-40.53 3.18s-8.6-28.24 4.38-40.55c16.54-15.7 33.06-31.41 56.4-53.59-20.08-17-38.19-31.84-55.64-47.38-14-12.48-19.23-27.9-4.12-42.21 14-13.22 28.46-7.8 40.57 5.12 15.57 16.61 31.06 33.28 50.39 54 20-21.34 35.94-38.68 52.21-55.74 11.81-12.39 26-15.48 38.77-3.31 13.88 13.24 10.45 27.93-2.62 40.51-16.95 16.31-34.17 32.32-55.13 52.1 20.1 18.64 37.31 34.56 54.38 50.64z\"\n></path>\n</svg>`;\n\nconst deleteIcon = `<svg\nclass=\"delete-icon\"\nxmlns=\"http://www.w3.org/2000/svg\"\nx=\"0\"\ny=\"0\"\nviewBox=\"0 0 7 10.583\"\n>\n<g color=\"#000\" fontFamily=\"sans-serif\">\n  <path\n    style={{\n      lineHeight: \"normal\",\n      fontVariantLigatures: \"normal\",\n      fontVariantPosition: \"normal\",\n      fontVariantCaps: \"normal\",\n      fontVariantNumeric: \"normal\",\n      fontVariantAlternates: \"normal\",\n      fontVariantEastAsian: \"normal\",\n      fontFeatureSettings: \"normal\",\n      fontVariationSettings: \"normal\",\n      WebkitTextIndent: \"0\",\n      textIndent: \"0\",\n      WebkitTextAlign: \"start\",\n      textAlign: \"start\",\n      WebkitTextDecorationLine: \"none\",\n      textDecorationLine: \"none\",\n      WebkitTextDecorationStyle: \"solid\",\n      textDecorationStyle: \"solid\",\n      WebkitTextDecorationColor: \"#000000\",\n      textDecorationColor: \"#000000\",\n      WebkitTextTransform: \"none\",\n      textTransform: \"none\",\n      WebkitTextOrientation: \"mixed\",\n      textOrientation: \"mixed\",\n      whiteSpace: \"normal\",\n      shapePadding: \"0\",\n      shapeMargin: \"0\",\n      inlineSize: \"0\",\n      isolation: \"auto\",\n      mixBlendMode: \"normal\",\n      solidColor: \"#000000\",\n      solidOpacity: \"1\",\n    }}\n    d=\"M3.506-52.386a.796.796 0 00-.793.792v.264H.799a.265.265 0 100 .529h.474l.315 4.672c.042.619.525 1.15 1.168 1.15H5.71c.643 0 1.125-.531 1.168-1.15l.316-4.672h.473a.265.265 0 100-.53H5.754v-.263a.796.796 0 00-.793-.792zm0 .529H4.96c.151 0 .263.112.263.263v.264H3.24v-.264c0-.15.115-.263.266-.263zM1.8-50.801h4.865l-.313 4.635c-.026.38-.283.658-.641.658H2.756c-.358 0-.615-.279-.64-.658z\"\n    enableBackground=\"accumulate\"\n    overflow=\"visible\"\n    transform=\"translate(0 52.916)\"\n  ></path>\n  <path\n    style={{\n      lineHeight: \"normal\",\n      fontVariantLigatures: \"normal\",\n      fontVariantPosition: \"normal\",\n      fontVariantCaps: \"normal\",\n      fontVariantNumeric: \"normal\",\n      fontVariantAlternates: \"normal\",\n      fontVariantEastAsian: \"normal\",\n      fontFeatureSettings: \"normal\",\n      fontVariationSettings: \"normal\",\n      WebkitTextIndent: \"0\",\n      textIndent: \"0\",\n      WebkitTextAlign: \"start\",\n      textAlign: \"start\",\n      WebkitTextDecorationLine: \"none\",\n      textDecorationLine: \"none\",\n      WebkitTextDecorationStyle: \"solid\",\n      textDecorationStyle: \"solid\",\n      WebkitTextDecorationColor: \"#000000\",\n      textDecorationColor: \"#000000\",\n      WebkitTextTransform: \"none\",\n      textTransform: \"none\",\n      WebkitTextOrientation: \"mixed\",\n      textOrientation: \"mixed\",\n      whiteSpace: \"normal\",\n      shapePadding: \"0\",\n      shapeMargin: \"0\",\n      inlineSize: \"0\",\n      isolation: \"auto\",\n      mixBlendMode: \"normal\",\n      solidColor: \"#000000\",\n      solidOpacity: \"1\",\n    }}\n    d=\"M3.44-49.742a.265.265 0 00-.264.265v2.645a.265.265 0 00.263.266.265.265 0 00.266-.266v-2.645a.265.265 0 00-.266-.265zM5.027-49.742a.265.265 0 00-.265.265v2.645a.265.265 0 00.265.266.265.265 0 00.264-.266v-2.645a.265.265 0 00-.264-.265z\"\n    enableBackground=\"accumulate\"\n    overflow=\"visible\"\n    transform=\"translate(0 52.916)\"\n  ></path>\n</g><svg>`;\n\nconst bottomArrowIcon = `<svg\nxmlns=\"http://www.w3.org/2000/svg\"\nx=\"0\"\ny=\"0\"\nenableBackground=\"new 0 0 48 48\"\nviewBox=\"0 0 48 60\"\n>\n<path d=\"M47.8 7.1C47.4 6.4 46.7 6 46 6H2C1.3 6 .6 6.4.2 7.1s-.3 1.5.1 2.1l22 32c.4.5 1 .9 1.6.9s1.3-.3 1.6-.9l22-32c.6-.7.6-1.5.3-2.1z\"></path>\n</svg>`\n\nmodule.exports = { crossIcon, deleteIcon, bottomArrowIcon };\n","const dropdownOptions = {\n  A: \"Ala\",\n  R: \"Arg\",\n  N: \"Asn\",\n  D: \"Asp\",\n  C: \"Cys\",\n  E: \"Glu\",\n  Q: \"Gln\",\n  G: \"Gly\",\n  H: \"His\",\n  I: \"Ile\",\n  L: \"Leu\",\n  K: \"Lys\",\n  M: \"Met\",\n  F: \"Phe\",\n  P: \"Pro\",\n  S: \"Ser\",\n  T: \"Thr\",\n  W: \"Trp\",\n  Y: \"Tyr\",\n  V: \"Val\",\n};\n\nmodule.exports = { dropdownOptions };\n","const createFeature = require('./feature-viewer')\n\nconst Nextprot = require(\"nextprot/src/nextprot-core.js\");\nconst NXUtils = require(\"nextprot/src/nextprot-utils.js\")[\"NXUtils\"];\nconst NXViewerUtils = require(\"nextprot/src/nextprot-utils.js\")[\"NXViewerUtils\"];\n\nvar nxClient;\n\nfunction nxFeatureViewer(nx, entry, div, options) {\n    nxClient = nx;\n    return new Promise(function(resolve, reject) {\n        var ft;\n        var isoform = entry;\n        var sequence = \"\";\n        if (entry.startsWith(\"NX_\")) {\n            var isoNb = isoform.split(\"-\")[1] ? isoform : isoform.split(\"-\")[0] + \"-1\";\n            var nxEntry = isoform.split(\"-\")[0];\n            nx.getProteinSequence(nxEntry).then(function (data) {\n                var isoSeq = data.filter(function(iso) {return iso.uniqueName === isoNb});\n                var sequence = isoSeq[0].sequence;\n                createFeature.prototype.isoform = isoNb;\n                createFeature.prototype.entry = nxEntry;\n                createFeature.prototype.nxClient = nx;\n                createFeature.prototype.addNxFeature = addNxFeature;\n                ft = new createFeature(sequence, div, options);\n                resolve(ft);\n            })\n        }\n    });\n\n}\n\nfunction filterFeatures(featuresForViewer, viewer) {\n    var isoName = viewer.isoform;\n    for (var i = 0; i < featuresForViewer.length; i++) {\n        if (Object.keys(featuresForViewer[i]).length !== 0 && featuresForViewer[i].hasOwnProperty(isoName)) {\n            var feature = jQuery.extend({}, featuresForViewer[i][isoName]);\n            viewer.addFeature(feature);\n        }\n    }\n}\n\nfunction mergeData(oneData, metaData, viewer) {\n    featuresForViewer = [];\n\n    for (var i = 0; i < oneData.length; i++) {\n        var feat = NXUtils.convertMappingsToIsoformMap(oneData[i], metaData[i].name, metaData[i].filter);\n        var featForViewer = NXViewerUtils.convertNXAnnotations(feat, metaData[i]);\n        featuresForViewer.push(featForViewer);\n    }\n    return featuresForViewer;\n}\n\nfunction getFeaturesByview(nx, list, entry) {\n    \n    var data = [];\n    for (var feat in list) {\n        switch (list[feat]) {\n        case \"sequence\":\n            data.push(nx.getProteinSequence(entry));\n            break;\n        case \"antibody\":\n            data.push(nx.getAntibody(entry));\n            break;\n        case \"isoform-mapping\":\n            data.push(nx.getIsoformMapping(entry));\n            break;\n        default:\n            data.push(nx.getAnnotationsByCategory(entry, list[feat]));\n            break;\n        }\n    }\n    return data;\n}\n\nfunction addNxFeature(featuresName, featuresStyle) {\n    var that = this;\n    return new Promise(function(resolve, reject) {\n        Promise.all(getFeaturesByview(that.nxClient, featuresName, that.entry))\n            .then(function (oneData) {\n                var featuresForViewer = mergeData(oneData, featuresStyle);\n                filterFeatures(featuresForViewer, that);\n                resolve(that);\n            }).catch(function (err) {\n                // catch any error that happened so far\n                console.log(\"Argh, broken: \" + err.message);\n                console.log(\"Error at line : \" + err.stack);\n            });\n        \n    });\n}\n\nif ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\n    module.exports = nxFeatureViewer;\n}","import { FeatureListType } from \"./types\";\n\nexport const featureList: FeatureListType[] = [\n  {\n    APIRef: \"sequence\",\n    metadata: { name: \"Sequence\" },\n  },\n  {\n    APIRef: \"signal-peptide\",\n    metadata: {\n      name: \"Signal peptide\",\n      className: \"sign\",\n      color: \"#B3B3E1\",\n      type: \"rect\",\n      filter: \"Processing\",\n    },\n  },\n  {\n    APIRef: \"propeptide\",\n    metadata: {\n      name: \"Propeptide\",\n      className: \"pro\",\n      color: \"#B3B3B3\",\n      type: \"rect\",\n      filter: \"Processing\",\n    },\n  },\n  {\n    APIRef: \"mature-protein\",\n    metadata: {\n      name: \"Mature protein\",\n      className: \"mat\",\n      color: \"#B3B3C2\",\n      type: \"rect\",\n      filter: \"Processing\",\n    },\n  },\n  {\n    APIRef: \"initiator-methionine\",\n    metadata: {\n      name: \"Initiator Met\",\n      className: \"initMeth\",\n      color: \"#B3B3D1\",\n      type: \"unique\",\n      filter: \"Processing\",\n    },\n  },\n  {\n    APIRef: \"peroxisome-transit-peptide\",\n    metadata: {\n      name: \"Transit peptide\",\n      className: \"pero\",\n      color: \"#B3B3F0\",\n      type: \"rect\",\n      filter: \"Processing\",\n    },\n  },\n  {\n    APIRef: \"mitochondrial-transit-peptide\",\n    metadata: {\n      name: \"Transit peptide\",\n      className: \"mito\",\n      color: \"#B3B3F0\",\n      type: \"rect\",\n      filter: \"Processing\",\n    },\n  },\n  {\n    APIRef: \"miscellaneous-region\",\n    metadata: {\n      name: \"Region\",\n      className: \"miscregion\",\n      color: \"#B3C2B3\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"domain\",\n    metadata: {\n      name: \"Domain\",\n      className: \"domain\",\n      color: \"#B3C2C2\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"repeat\",\n    metadata: {\n      name: \"Repeat\",\n      className: \"repeat\",\n      color: \"#98B7D5\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"calcium-binding-region\",\n    metadata: {\n      name: \"Calcium binding\",\n      className: \"calcium\",\n      color: \"#B3C2E1\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"zinc-finger-region\",\n    metadata: {\n      name: \"Zinc finger\",\n      className: \"calcium\",\n      color: \"#B3C2E1\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"beta-strand\",\n    metadata: {\n      name: \"Beta strand\",\n      className: \"betastrand\",\n      color: \"#B3F0C2\",\n      type: \"rect\",\n      filter: \"Secondary structure\",\n    },\n  },\n  {\n    APIRef: \"helix\",\n    metadata: {\n      name: \"Helix\",\n      className: \"helix\",\n      color: \"#B3F0D1\",\n      type: \"rect\",\n      filter: \"Secondary structure\",\n    },\n  },\n  {\n    APIRef: \"turn\",\n    metadata: {\n      name: \"Turn\",\n      className: \"turn\",\n      color: \"#B3F0E1\",\n      type: \"rect\",\n      filter: \"Secondary structure\",\n    },\n  },\n  {\n    APIRef: \"dna-binding-region\",\n    metadata: {\n      name: \"DNA binding\",\n      className: \"dnabind\",\n      color: \"#B3C2FF\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"nucleotide-phosphate-binding-region\",\n    metadata: {\n      name: \"Nucleotide binding\",\n      className: \"nucleobind\",\n      color: \"#B3D1B3\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"coiled-coil-region\",\n    metadata: {\n      name: \"Coiled-coil\",\n      className: \"coiledcoil\",\n      color: \"#B3D1C2\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"short-sequence-motif\",\n    metadata: {\n      name: \"Sequence motif\",\n      className: \"motif\",\n      color: \"#B3D1D1\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"compositionally-biased-region\",\n    metadata: {\n      name: \"Composition bias\",\n      className: \"biased\",\n      color: \"#B3D1E1\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"topological-domain\",\n    metadata: {\n      name: \"Topological domain\",\n      className: \"topodomain\",\n      color: \"#A5DBA5\",\n      type: \"rect\",\n      filter: \"Topology\",\n    },\n  },\n  {\n    APIRef: \"transmembrane-region\",\n    metadata: {\n      name: \"Membrane\",\n      className: \"membrane\",\n      color: \"#A5DBB7\",\n      type: \"rect\",\n      filter: \"Topology\",\n    },\n  },\n  {\n    APIRef: \"intramembrane-region\",\n    metadata: {\n      name: \"Membrane\",\n      className: \"intramembrane\",\n      color: \"#A5DBB7\",\n      type: \"rect\",\n      filter: \"Topology\",\n    },\n  },\n  {\n    APIRef: \"disulfide-bond\",\n    metadata: {\n      name: \"Disulfide bond\",\n      className: \"dsB\",\n      color: \"#B3B3E1\",\n      type: \"path\",\n      filter: \"Modified Residue\",\n    },\n  },\n  {\n    APIRef: \"interacting-region\",\n    metadata: {\n      name: \"Interacting region\",\n      className: \"intReg\",\n      color: \"#B3D1F0\",\n      type: \"rect\",\n      filter: \"Region\",\n    },\n  },\n  {\n    APIRef: \"modified-residue\",\n    metadata: {\n      name: \"Modified residue\",\n      className: \"modifRes\",\n      color: \"#B3C2B3\",\n      type: \"unique\",\n      filter: \"Modified Residue\",\n    },\n  },\n  {\n    APIRef: \"cross-link\",\n    metadata: {\n      name: \"Cross-link\",\n      className: \"crossLink\",\n      color: \"#B3C2C2\",\n      type: \"unique\",\n      filter: \"Modified Residue\",\n    },\n  },\n  {\n    APIRef: \"glycosylation-site\",\n    metadata: {\n      name: \"Glycosylation\",\n      className: \"glycoSite\",\n      color: \"#74E374\",\n      type: \"unique\",\n      filter: \"Modified Residue\",\n    },\n  },\n  {\n    APIRef: \"miscellaneous-site\",\n    metadata: {\n      name: \"Site\",\n      className: \"site\",\n      color: \"#B3F0E1\",\n      type: \"unique\",\n      filter: \"Site\",\n    },\n  },\n  {\n    APIRef: \"selenocysteine\",\n    metadata: {\n      name: \"Non-standard AA\",\n      className: \"seleno\",\n      color: \"#859DE7\",\n      type: \"unique\",\n      filter: \"Modified Residue\",\n    },\n  },\n  {\n    APIRef: \"active-site\",\n    metadata: {\n      name: \"Active site\",\n      className: \"actSite\",\n      color: \"#B3F0F0\",\n      type: \"unique\",\n      filter: \"Site\",\n    },\n  },\n  {\n    APIRef: \"binding-site\",\n    metadata: {\n      name: \"Binding site\",\n      className: \"bindsite\",\n      color: \"#82E6FF\",\n      type: \"unique\",\n      filter: \"Site\",\n    },\n  },\n  {\n    APIRef: \"cleavage-site\",\n    metadata: {\n      name: \"Cleavage site\",\n      className: \"cleavsite\",\n      color: \"#B3FFB3\",\n      type: \"unique\",\n      filter: \"Site\",\n    },\n  },\n  {\n    APIRef: \"metal-binding-site\",\n    metadata: {\n      name: \"Metal binding\",\n      className: \"metal\",\n      color: \"#B3FFC2\",\n      type: \"unique\",\n      filter: \"Site\",\n    },\n  },\n  {\n    APIRef: \"lipidation-site\",\n    metadata: {\n      name: \"Lipidation\",\n      className: \"lipidation\",\n      color: \"#A3B5DB\",\n      type: \"unique\",\n      filter: \"Modified Residue\",\n    },\n  },\n  {\n    APIRef: \"variant\",\n    metadata: {\n      name: \"Variant\",\n      className: \"variant\",\n      color: \"rgba(0,255,154,0.3)\",\n      type: \"unique\",\n      filter: \"Variant\",\n    },\n  },\n  {\n    APIRef: \"mutagenesis\",\n    metadata: {\n      name: \"Mutagenesis\",\n      className: \"mutagenesis\",\n      color: \"#73FFE3\",\n      type: \"unique\",\n      filter: \"Variant\",\n    },\n  },\n  {\n    APIRef: \"isoform-mapping\",\n    metadata: {\n      name: \"Isoform\",\n    },\n  },\n];\n","import { NXUtils, NXViewerUtils } from \"feature-viewer\";\n\nimport {\n  FeatsForViewer,\n  FeatureData,\n  FeatureListType,\n  MetaData,\n} from \"../types\";\nimport { featureList } from \"../featureList\";\n\nexport function getFeaturesByView(\n  featureList: FeatureListType[],\n  nx: any,\n  nxEntry: string,\n) {\n  let featuresForViewer = [];\n\n  for (let feat in featureList) {\n    switch (featureList[feat].APIRef) {\n      case \"sequence\":\n        featuresForViewer.push(nx.getProteinSequence(nxEntry));\n        break;\n      case \"antibody\":\n        featuresForViewer.push(nx.getAntibody(nxEntry));\n        break;\n      case \"isoform-mapping\":\n        featuresForViewer.push(nx.getIsoformMapping(nxEntry));\n        break;\n      case \"variant-medical\":\n        featuresForViewer.push(\n          nx.getAnnotationsWithProperty(\n            nxEntry,\n            \"variant\",\n            \"disease-related\",\n            true,\n          ),\n        );\n        break;\n      case \"miscellaneous-region-interactions\":\n        featuresForViewer.push(\n          nx.getAnnotationsWithProperty(\n            nxEntry,\n            \"miscellaneous-region\",\n            \"interaction-related\",\n            true,\n          ),\n        );\n        break;\n      default:\n        featuresForViewer.push(\n          nx.getAnnotationsByCategory(nxEntry, featureList[feat].APIRef),\n        );\n        break;\n    }\n  }\n  return featuresForViewer;\n}\n\nexport function getFeaturesByIsoform(rawData: any, metaData: MetaData[]) {\n  let featuresForViewer = [];\n  let featForViewer;\n\n  for (let i = 1; i < rawData.length - 1; i++) {\n    let feat = NXUtils.convertMappingsToIsoformMap(\n      rawData[i],\n      metaData[i].name.replace(\".\", \"\"),\n      metaData[i].filter,\n      \"\",\n    );\n\n    featForViewer = NXViewerUtils.convertNXAnnotations(feat, metaData[i], {});\n    featuresForViewer.push(featForViewer);\n  }\n  return featuresForViewer;\n}\n\nexport function addFeatures(\n  featuresForViewer: FeatsForViewer[],\n  isoName: string,\n) {\n  let featureList: FeatureData[] = [];\n\n  featuresForViewer.map((currentFeature) => {\n    if (\n      Object.keys(currentFeature).length !== 0 &&\n      Object.prototype.hasOwnProperty.call(currentFeature, isoName)\n    ) {\n      featureList.push({ ...currentFeature[isoName] });\n    }\n  });\n  return featureList;\n}\n\nexport function getMetadataByView() {\n  let metaData: MetaData[] = [];\n\n  featureList.map((_, i) => {\n    metaData.push(featureList[i].metadata);\n  });\n  return metaData;\n}\n","import Papa from \"papaparse\";\n\ntype FileProps = {\n  columns: any;\n  data: any;\n  fileType: string;\n};\n\nexport function getExportFileBlob(props: FileProps) {\n  const { columns, data, fileType } = props;\n  console.log(columns);\n  console.log(data);\n  console.log(fileType);\n  if (fileType === \"csv\") {\n    const headerNames = columns.map((col: any) => col.exportValue);\n    const csvString = Papa.unparse({ fields: headerNames, data });\n    return new Blob([csvString], { type: \"text/csv\" });\n  }\n}\n","export const ERROR = {\n  NOT_FOUND: \"Couldn't find entry data.\",\n};\n\nexport const TABLE_PAGE_SIZE = 10;\n","import {\n  useTable,\n  useAsyncDebounce,\n  usePagination,\n  useGlobalFilter,\n} from \"react-table\";\nimport { useExportData } from \"react-table-plugins\";\nimport React, { useState, useMemo } from \"react\";\n\nimport { getExportFileBlob } from \"../utils/exportFile\";\nimport { VariantData } from \"../utils/types\";\nimport { TABLE_PAGE_SIZE } from \"../utils/constants\";\n\nconst RESULT_COLUMN_DATA = [\n  {\n    Header: \"S. No.\",\n    accessor: \"id\",\n    Cell: function rowSerial(row: any) {\n      return <div>{Number(row.row.id) + 1}</div>;\n    },\n  },\n  {\n    Header: \"Position\",\n    accessor: \"position\",\n  },\n  {\n    Header: \"Original\",\n    accessor: \"original\",\n  },\n  {\n    Header: \"Variant\",\n    accessor: \"variant\",\n  },\n  {\n    Header: \"sift\",\n    accessor: \"sift\",\n  },\n  {\n    Header: \"polyphen\",\n    accessor: \"polyphen\",\n  },\n];\n\ntype TableProps = {\n  data: VariantData[];\n};\n\nfunction GlobalFilter({\n  preGlobalFilteredRows,\n  globalFilter,\n  setGlobalFilter,\n}: any) {\n  const count =\n    preGlobalFilteredRows.length > 0 ? preGlobalFilteredRows.length : 0;\n\n  const [value, setValue] = useState(globalFilter);\n\n  const onChange = useAsyncDebounce((value) => {\n    setGlobalFilter(value || undefined);\n  }, 200);\n\n  return (\n    <input\n      className=\"search-input\"\n      value={value || \"\"}\n      onChange={(e) => {\n        setValue(e.target.value);\n        onChange(e.target.value);\n      }}\n      placeholder={`Search ${count} records...`}\n    />\n  );\n}\n\nconst Table = (props: TableProps) => {\n  const { data } = props;\n\n  const columns = useMemo(() => RESULT_COLUMN_DATA, []);\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    prepareRow,\n    page,\n    state,\n    canPreviousPage,\n    canNextPage,\n    pageOptions,\n    pageCount,\n    gotoPage,\n    nextPage,\n    preGlobalFilteredRows,\n    setGlobalFilter,\n    previousPage,\n    setPageSize,\n    state: { pageIndex, pageSize },\n    exportData,\n  } = useTable(\n    {\n      //@ts-ignore\n      columns,\n      data,\n      getExportFileBlob,\n      initialState: { pageIndex: 0, pageSize: TABLE_PAGE_SIZE },\n    },\n    useGlobalFilter,\n    usePagination,\n    useExportData,\n  );\n\n  return (\n    <div className=\"variant-table-container\">\n      <div className=\"table-header\">\n        <GlobalFilter\n          preGlobalFilteredRows={preGlobalFilteredRows}\n          globalFilter={state.globalFilter}\n          setGlobalFilter={setGlobalFilter}\n        />\n        <button\n          className=\"export-btn\"\n          onClick={() => {\n            exportData(\"csv\", true);\n          }}\n        >\n          Export All as CSV\n        </button>\n      </div>\n      <table {...getTableProps()} className=\"variant-data-table\">\n        <thead>\n          {headerGroups.map((headerGroup, i) => {\n            return (\n              <tr\n                {...headerGroup.getHeaderGroupProps()}\n                key={headerGroup.headers[i].id}\n              >\n                {headerGroup.headers.map((column) => {\n                  return (\n                    <th {...column.getHeaderProps()} key={column.id}>\n                      {column.render(\"Header\")}\n                    </th>\n                  );\n                })}\n              </tr>\n            );\n          })}\n        </thead>\n        <tbody {...getTableBodyProps()}>\n          {page.map((row) => {\n            prepareRow(row);\n            return (\n              <tr {...row.getRowProps()} key={row.original.position}>\n                {row.cells.map((cell) => {\n                  return (\n                    <td {...cell.getCellProps()} key={cell.value}>\n                      {cell.render(\"Cell\")}\n                    </td>\n                  );\n                })}\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n      {data.length === 0 ? (\n        <p className=\"table-text\">\n          <i>\n            No records added. Add variants and click on get predictions to get\n            results\n          </i>\n          .\n        </p>\n      ) : (\n        <div className=\"pagination\">\n          <button onClick={() => gotoPage(0)} disabled={!canPreviousPage}>\n            {\"<<\"}\n          </button>{\" \"}\n          <button onClick={() => previousPage()} disabled={!canPreviousPage}>\n            {\"<\"}\n          </button>{\" \"}\n          <button onClick={() => nextPage()} disabled={!canNextPage}>\n            {\">\"}\n          </button>{\" \"}\n          <button\n            onClick={() => gotoPage(pageCount - 1)}\n            disabled={!canNextPage}\n          >\n            {\">>\"}\n          </button>{\" \"}\n          <span>\n            Page{\" \"}\n            <strong>\n              {pageIndex + 1} of {pageOptions.length}\n            </strong>{\" \"}\n          </span>\n          <span>\n            | Go to page:{\" \"}\n            <input\n              type=\"number\"\n              defaultValue={pageIndex + 1 || 1}\n              onChange={(e) => {\n                const page = e.target.value ? Number(e.target.value) - 1 : 0;\n                gotoPage(page);\n              }}\n            />\n          </span>{\" \"}\n          <select\n            value={pageSize}\n            onBlur={(e) => {\n              setPageSize(Number(e.target.value));\n            }}\n          >\n            {[10, 20, 30, 40, 50].map((pageSize) => (\n              <option key={pageSize} value={pageSize}>\n                Show {pageSize}\n              </option>\n            ))}\n          </select>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Table;\n","import React, { useState, useEffect } from \"react\";\nimport Select from \"react-select\";\n\nimport { IsoformType } from \"../utils/types\";\n\ntype IsoformProps = {\n  isoName?: string;\n  isoform: IsoformType[];\n  handleIsoformChange: (value: string) => void;\n};\n\ntype Option = {\n  value: string;\n  label: string;\n};\n\nconst Isoform = ({ isoform, handleIsoformChange }: IsoformProps) => {\n  const [options, setOptions] = useState<Option[]>();\n  const [selectedOption, setSelectedOption] = useState<Option>();\n\n  useEffect(() => {\n    let optionMap: Option[] = [];\n    isoform.map((iso: IsoformType) => {\n      const option = {\n        value: iso.isoformAccession,\n        label: iso.isoformAccession,\n      };\n      optionMap.push(option);\n    });\n    setOptions(optionMap);\n    setSelectedOption(optionMap[0]);\n  }, [isoform]);\n\n  if (!options) {\n    return <></>;\n  }\n\n  return (\n    <div className=\"isoform-select-wrapper\">\n      <p>Change Isoform</p>\n      <Select\n        className=\"isoform-select\"\n        options={options}\n        value={selectedOption}\n        defaultValue={selectedOption}\n        onChange={(option) => {\n          handleIsoformChange(option!.value);\n          setSelectedOption(option!);\n        }}\n      />\n    </div>\n  );\n};\n\nexport default Isoform;\n","import React, { useEffect, useState } from \"react\";\nimport { Nextprot, createFeature } from \"feature-viewer\";\n\nimport { featureList } from \"../utils/featureList\";\nimport {\n  getFeaturesByView,\n  getFeaturesByIsoform,\n  addFeatures,\n  getMetadataByView,\n} from \"../utils/helpers/getFeatures\";\nimport Table from \"./Table\";\nimport Isoform from \"./Isoform\";\nimport {\n  FeatsForViewer,\n  FeatureData,\n  IsoformType,\n  MetaData,\n  VariantData,\n} from \"../utils/types\";\nimport { ERROR } from \"../utils/constants\";\n\nconst FeatureViewerComponent = () => {\n  const [data, setData] = useState<VariantData[] | []>([]);\n  const [isoform, setIsoform] = useState<IsoformType[]>();\n  const [isoName, setIsoName] = useState<string>();\n  const [features, setFeatures] = useState<FeatsForViewer[]>();\n  const [error, setError] = useState<string | null>(null);\n\n  const CONTAINER_ID = \"fv1\";\n  const nx = new Nextprot.Client(\"Calipho Group\", \"VEP community tool\");\n  let fv: any;\n\n  function buildFeatures(\n    fv: any,\n    sequences: IsoformType[],\n    isoName: string,\n    features: FeatureData[],\n  ) {\n    sequences.forEach(function (seq: IsoformType) {\n      if (seq.uniqueName === isoName) {\n        fv = new createFeature(seq.sequence, \"#fv1\", {\n          showAxis: true,\n          showSequence: true,\n          brushActive: true,\n          toolbar: true,\n          bubbleHelp: true,\n          zoomMax: 10,\n          variant: true,\n        });\n\n        features.map((feat: FeatureData) => {\n          fv.addFeature(feat);\n        });\n\n        fv.onVariantAdded((d: CustomEvent) => {\n          setData([...d.detail]);\n        });\n\n        fv.onGetPredictions((d: CustomEvent) => {\n          const variantValues = d.detail;\n\n          variantValues.map((v: VariantData) => {\n            v.sift = Math.random().toFixed(2);\n            v.polyphen = Math.random().toFixed(2);\n          });\n\n          setData(variantValues);\n        });\n      }\n    });\n  }\n\n  function handleIsoformChange(value: string) {\n    setIsoName(value);\n    document.getElementById(CONTAINER_ID)!.innerHTML = \"\";\n    const featureList: FeatureData[] = addFeatures(features!, value);\n    buildFeatures(fv, isoform!, value, featureList);\n  }\n\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const paramEntry: string | null = params.get(\"entry\");\n\n    let sequences: IsoformType[];\n    let features: FeatureData[];\n\n    Promise.all(getFeaturesByView(featureList, nx, paramEntry!))\n      .then((rawData) => {\n        if (rawData) {\n          sequences = rawData[0];\n          const metadata: MetaData[] = getMetadataByView();\n          const featsForViewer: FeatsForViewer[] = getFeaturesByIsoform(\n            rawData,\n            metadata,\n          );\n          features = addFeatures(featsForViewer, sequences[0].isoformAccession);\n          buildFeatures(fv, sequences, sequences[0].isoformAccession, features);\n\n          setIsoform(sequences);\n          setFeatures(featsForViewer);\n          setIsoName(sequences[0].isoformAccession);\n        } else {\n          setError(ERROR.NOT_FOUND);\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, []);\n\n  return (\n    <div className=\"viewer-container\">\n      {isoform && !error && (\n        <Isoform\n          isoName={isoName}\n          isoform={isoform}\n          handleIsoformChange={handleIsoformChange}\n        />\n      )}\n      <div id=\"fv1\" />\n      <Table data={data} />\n    </div>\n  );\n};\n\nexport default FeatureViewerComponent;\n","export default __webpack_public_path__ + \"static/media/nextprot-logo.d0c0c045.png\";","import React from \"react\";\nimport FeatureViewerComponent from \"./components/FeatureViewer\";\nimport nextprotLogo from \"./utils/icons/nextprot-logo.png\";\nimport \"./App.css\";\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n      <img src={nextprotLogo} className=\"logo\" alt=\"neXtProt logo\" />\n      <FeatureViewerComponent />\n    </div>\n  );\n};\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(`web-vitals`).then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\"),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}